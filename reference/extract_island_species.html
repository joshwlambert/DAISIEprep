<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extracts the colonisation, diversification, and endemicty data from phylogenetic and endemicity data and stores it in an Island_tbl object — extract_island_species • DAISIEprep</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extracts the colonisation, diversification, and endemicty data from phylogenetic and endemicity data and stores it in an Island_tbl object — extract_island_species"><meta name="description" content="Extracts the colonisation, diversification, and endemicty data from
phylogenetic and endemicity data and stores it in an Island_tbl object"><meta property="og:description" content="Extracts the colonisation, diversification, and endemicty data from
phylogenetic and endemicity data and stores it in an Island_tbl object"><meta property="og:image" content="https://joshwlambert.github.io/DAISIEprep/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAISIEprep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorial</h6></li>
    <li><a class="dropdown-item" href="../articles/Tutorial.html">DAISIEprep Tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Forcing nonendemic singletons</h6></li>
    <li><a class="dropdown-item" href="../articles/Forcing_nonendemic_singleton.html">Forcing non-endemic singletons: solutions and limitations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extending ASR</h6></li>
    <li><a class="dropdown-item" href="../articles/Extending_asr.html">Extending DAISIEprep ASR models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6></li>
    <li><a class="dropdown-item" href="../articles/Sensitivity.html">Sensitivity</a></li>
    <li><a class="dropdown-item" href="../articles/Performance.html">Performance</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joshwlambert/DAISIEprep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extracts the colonisation, diversification, and endemicty data from phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object</h1>
      <small class="dont-index">Source: <a href="https://github.com/joshwlambert/DAISIEprep/blob/master/R/extract_island_species.R" class="external-link"><code>R/extract_island_species.R</code></a></small>
      <div class="d-none name"><code>extract_island_species.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extracts the colonisation, diversification, and endemicty data from
phylogenetic and endemicity data and stores it in an <code>Island_tbl</code> object</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract_island_species</span><span class="op">(</span></span>
<span>  <span class="va">phylod</span>,</span>
<span>  <span class="va">extraction_method</span>,</span>
<span>  island_tbl <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include_not_present <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nested_asr_species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"split"</span>, <span class="st">"group"</span><span class="op">)</span>,</span>
<span>  force_nonendemic_singleton <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  unique_clade_name <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phylod">phylod<a class="anchor" aria-label="anchor" href="#arg-phylod"></a></dt>
<dd><p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p></dd>


<dt id="arg-extraction-method">extraction_method<a class="anchor" aria-label="anchor" href="#arg-extraction-method"></a></dt>
<dd><p>A character string specifying whether the
colonisation time extracted is the minimum time (<code>min</code>) (before the present),
or the most probable time under ancestral state reconstruction (<code>asr</code>).</p></dd>


<dt id="arg-island-tbl">island_tbl<a class="anchor" aria-label="anchor" href="#arg-island-tbl"></a></dt>
<dd><p>An instance of the <code>Island_tbl</code> class.</p></dd>


<dt id="arg-include-not-present">include_not_present<a class="anchor" aria-label="anchor" href="#arg-include-not-present"></a></dt>
<dd><p>A boolean determining whether species not present
on the island should be included in island colonist when embedded within an
island clade. Default is FALSE.</p></dd>


<dt id="arg-nested-asr-species">nested_asr_species<a class="anchor" aria-label="anchor" href="#arg-nested-asr-species"></a></dt>
<dd><p>A <code>character</code> string which determines whether
<em>nested island colonists</em> are split into separate colonists (<code>"split"</code>), or
grouped into a single clade (<code>"group"</code>). Nested species are those whose tip
state is on the island, and they have ancestral nodes on the island, but
there are nodes in between these island state nodes that have the state
<code>not_present</code> (i.e. not on the island). Therefore, the colonisation time
can be extracted as the most recent node state on the island (this can be
the branching time before the tip if the ancestor node of the tip is not
on the island), or the older node state of the larger clade, for <code>"split"</code>
or <code>"group"</code> respectively. <strong>Note</strong> This argument only applies when
<code>extraction_method = "asr"</code>.</p></dd>


<dt id="arg-force-nonendemic-singleton">force_nonendemic_singleton<a class="anchor" aria-label="anchor" href="#arg-force-nonendemic-singleton"></a></dt>
<dd><p>A boolean that determines whether all
species that are classified as <code>"nonendemic"</code> are forced to be extracted as
singletons (i.e single species lineages). By default it is <code>FALSE</code> so
non-endemics can be extracted either as singletons or part of an endemic
clade. When set to <code>TRUE</code> all non-endemic species in the tree will be
single species colonists, with the colonisation time extracted as the stem
age for the tip in the phylogeny. There are some exceptions to this, please
see <code><a href="../articles/Forcing_nonendemic_singleton.html">vignette("Forcing_nonendemic_singleton", package = "DAISIEprep")</a></code> for more details.</p>
<p>This argument is only active when <code>extraction_method = "asr"</code>, when
<code>extraction_method = "min"</code> this argument will be ignored with a warning,
as the <code>min</code> method always extracts non-endemic species as singletons.</p></dd>


<dt id="arg-unique-clade-name">unique_clade_name<a class="anchor" aria-label="anchor" href="#arg-unique-clade-name"></a></dt>
<dd><p>Boolean determining whether a unique species
identifier is used as the clade name in the Island_tbl object or a genus
name which may not be unique if that genus has several independent island
colonisations</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of <code>Island_tbl</code> class</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  kind <span class="op">=</span> <span class="st">"Mersenne-Twister"</span>,</span></span>
<span class="r-in"><span>  normal.kind <span class="op">=</span> <span class="st">"Inversion"</span>,</span></span>
<span class="r-in"><span>  sample.kind <span class="op">=</span> <span class="st">"Rejection"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phylo</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rcoal</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phylo</span><span class="op">$</span><span class="va">tip.label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bird_a"</span>, <span class="st">"bird_b"</span>, <span class="st">"bird_c"</span>, <span class="st">"bird_d"</span>, <span class="st">"bird_e"</span>,</span></span>
<span class="r-in"><span>                     <span class="st">"bird_f"</span>, <span class="st">"bird_g"</span>, <span class="st">"bird_h"</span>, <span class="st">"bird_i"</span>, <span class="st">"bird_j"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phylo</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4-methods.html" class="external-link">phylo4</a></span><span class="op">(</span><span class="va">phylo</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not_present"</span>, <span class="st">"endemic"</span>, <span class="st">"nonendemic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/labels-methods.html" class="external-link">tipLabels</a></span><span class="op">(</span><span class="va">phylo</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  replace <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">phylo</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">endemicity_status</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">extract_island_species</span><span class="op">(</span><span class="va">phylod</span>, extraction_method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Class:  Island_tbl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   clade_name     status missing_species   col_time col_max_age branching_times</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     bird_g nonendemic               0 0.38003405       FALSE              NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     bird_i    endemic               0 0.04960523       FALSE              NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   min_age species clade_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1      NA  bird_g          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      NA  bird_i          1</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Luis Valente, Pedro Santos Neves, Lizzie Roeble, Theo Pannetier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>


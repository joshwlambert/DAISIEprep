<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fits a model of ancestral state reconstruction of island presence — add_asr_node_states • DAISIEprep</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fits a model of ancestral state reconstruction of island presence — add_asr_node_states"><meta name="description" content="Fits a model of ancestral state reconstruction of island presence"><meta property="og:description" content="Fits a model of ancestral state reconstruction of island presence"><meta property="og:image" content="https://joshwlambert.github.io/DAISIEprep/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAISIEprep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorial</h6></li>
    <li><a class="dropdown-item" href="../articles/Tutorial.html">DAISIEprep Tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Forcing nonendemic singletons</h6></li>
    <li><a class="dropdown-item" href="../articles/Forcing_nonendemic_singleton.html">Forcing non-endemic singletons: solutions and limitations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extracting multi-tip species</h6></li>
    <li><a class="dropdown-item" href="../articles/Multi_tip_extraction.html">Extracting species with multiple tips in the phylogeny</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extending ASR</h6></li>
    <li><a class="dropdown-item" href="../articles/Extending_asr.html">Extending DAISIEprep ASR models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6></li>
    <li><a class="dropdown-item" href="../articles/Sensitivity.html">Sensitivity</a></li>
    <li><a class="dropdown-item" href="../articles/Performance.html">Performance</a></li>
    <li><a class="dropdown-item" href="../articles/DAISIE_FAQs.html">DAISIE FAQs</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joshwlambert/DAISIEprep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fits a model of ancestral state reconstruction of island presence</h1>
      <small class="dont-index">Source: <a href="https://github.com/joshwlambert/DAISIEprep/blob/master/R/add_asr_node_states.R" class="external-link"><code>R/add_asr_node_states.R</code></a></small>
      <div class="d-none name"><code>add_asr_node_states.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a model of ancestral state reconstruction of island presence</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_asr_node_states</span><span class="op">(</span></span>
<span>  <span class="va">phylod</span>,</span>
<span>  <span class="va">asr_method</span>,</span>
<span>  tie_preference <span class="op">=</span> <span class="st">"island"</span>,</span>
<span>  earliest_col <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  rate_model <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phylod">phylod<a class="anchor" aria-label="anchor" href="#arg-phylod"></a></dt>
<dd><p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p></dd>


<dt id="arg-asr-method">asr_method<a class="anchor" aria-label="anchor" href="#arg-asr-method"></a></dt>
<dd><p>A character string, either "parsimony" or "mk" determines
whether a maximum parsimony or continuous-time markov model reconstructs the
ancestral states at each node. See documentation in
<code><a href="https://rdrr.io/pkg/castor/man/asr_max_parsimony.html" class="external-link">castor::asr_max_parsimony()</a></code> or <code><a href="https://rdrr.io/pkg/castor/man/asr_mk_model.html" class="external-link">castor::asr_mk_model()</a></code> in <code>castor</code> R
package for details on the methods used.</p></dd>


<dt id="arg-tie-preference">tie_preference<a class="anchor" aria-label="anchor" href="#arg-tie-preference"></a></dt>
<dd><p>Character string, either "island" or "mainland" to
choose the most probable state at each node using the <code><a href="https://rdrr.io/r/base/maxCol.html" class="external-link">max.col()</a></code> function.
When a node has island presence and absence equally probable we need to
decide whether that species should be considered on the island. To consider
it on the island use <code>ties.method = "last"</code> in the <code><a href="https://rdrr.io/r/base/maxCol.html" class="external-link">max.col()</a></code> function, if
you consider it not on the island use <code>ties.method = "first"</code>. Default is
"island".</p></dd>


<dt id="arg-earliest-col">earliest_col<a class="anchor" aria-label="anchor" href="#arg-earliest-col"></a></dt>
<dd><p>A boolean to determine whether to take the colonisation
time as the most probable time (FALSE) or the earliest possible colonisation
time (TRUE), where the probability of a species being on the island is
non-zero. Default is FALSE.</p></dd>


<dt id="arg-rate-model">rate_model<a class="anchor" aria-label="anchor" href="#arg-rate-model"></a></dt>
<dd><p>Rate model to be used for fitting the transition rate matrix. Can be "ER" (all rates equal), "SYM" (transition rate i–&gt;j is equal to transition rate j–&gt;i), "ARD" (all rates can be different), "SUEDE" (only stepwise transitions i–&gt;i+1 and i–&gt;i-1 allowed, all 'up' transitions are equal, all 'down' transitions are equal) or "SRD" (only stepwise transitions i–&gt;i+1 and i–&gt;i-1 allowed, and each rate can be different). Can also be an index matrix that maps entries of the transition matrix to the corresponding independent rate parameter to be fitted. Diagonal entries should map to 0, since diagonal entries are not treated as independent rate parameters but are calculated from the remaining entries in the transition matrix. All other entries that map to 0 represent a transition rate of zero. The format of this index matrix is similar to the format used by the <code>ace</code> function in the <code>ape</code> package. <code>rate_model</code> is only relevant if <code>transition_matrix==NULL</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p><a href="https://rdrr.io/r/base/dots.html" class="external-link">dots</a> Allows arguments to be passed to <code><a href="https://rdrr.io/pkg/castor/man/asr_mk_model.html" class="external-link">castor::asr_mk_model()</a></code>
and <code><a href="https://rdrr.io/pkg/castor/man/asr_max_parsimony.html" class="external-link">castor::asr_max_parsimony()</a></code>. These arguments must match by name
exactly, see <code>?castor::asr_mk_model()</code> and <code>?castor::asr_max_parsimony()</code>
for information on arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of <code>phylo4d</code> class with tip and node data</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>rate_model</code> argument documentation is inherited from
<code><a href="https://rdrr.io/pkg/castor/man/asr_mk_model.html" class="external-link">castor::asr_mk_model()</a></code>, therefore, the last sentence about the
<code>transition_matrix</code> argument does not apply to <code>add_asr_node_states()</code>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Luis Valente, Pedro Santos Neves, Lizzie Roeble, Theo Pannetier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>


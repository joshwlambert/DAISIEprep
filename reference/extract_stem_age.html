<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extracts the stem age from the phylogeny when the a species is known to belong to a genus but is not itself in the phylogeny and there are members of the same genus are in the phylogeny. The stem age can either be for the genus (or several genera) in the tree (stem = "genus") or use an extraction algorithm to find the stem of when the species colonised the island (stem = "island_presence), either 'min' or 'asr' as in extract_island_species(). When stem = "island_presence" the reconstructed node states are used to determine the stem age. — extract_stem_age • DAISIEprep</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extracts the stem age from the phylogeny when the a species is known to belong to a genus but is not itself in the phylogeny and there are members of the same genus are in the phylogeny. The stem age can either be for the genus (or several genera) in the tree (stem = " genus or use an extraction algorithm to find the stem of when species colonised island either as in extract_island_species reconstructed node states are used determine age. extract_stem_age><meta name="description" content="Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny. The stem age can either be for the
genus (or several genera) in the tree (stem = &quot;genus&quot;) or use an extraction
algorithm to find the stem of when the species colonised the island
(stem = &quot;island_presence), either 'min' or 'asr' as in
extract_island_species(). When stem = &quot;island_presence&quot;
the reconstructed node states are used
to determine the stem age."><meta property="og:description" content="Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny. The stem age can either be for the
genus (or several genera) in the tree (stem = &quot;genus&quot;) or use an extraction
algorithm to find the stem of when the species colonised the island
(stem = &quot;island_presence), either 'min' or 'asr' as in
extract_island_species(). When stem = &quot;island_presence&quot;
the reconstructed node states are used
to determine the stem age."><meta property="og:image" content="https://joshwlambert.github.io/DAISIEprep/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAISIEprep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorial</h6></li>
    <li><a class="dropdown-item" href="../articles/Tutorial.html">DAISIEprep Tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Forcing nonendemic singletons</h6></li>
    <li><a class="dropdown-item" href="../articles/Forcing_nonendemic_singleton.html">Forcing non-endemic singletons: solutions and limitations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extracting multi-tip species</h6></li>
    <li><a class="dropdown-item" href="../articles/Multi_tip_extraction.html">Extracting species with multiple tips in the phylogeny</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extending ASR</h6></li>
    <li><a class="dropdown-item" href="../articles/Extending_asr.html">Extending DAISIEprep ASR models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6></li>
    <li><a class="dropdown-item" href="../articles/Sensitivity.html">Sensitivity</a></li>
    <li><a class="dropdown-item" href="../articles/Performance.html">Performance</a></li>
    <li><a class="dropdown-item" href="../articles/DAISIE_FAQs.html">DAISIE FAQs</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joshwlambert/DAISIEprep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extracts the stem age from the phylogeny when the a species is known to belong to a genus but is not itself in the phylogeny and there are members of the same genus are in the phylogeny. The stem age can either be for the genus (or several genera) in the tree (<code>stem = "genus"</code>) or use an extraction algorithm to find the stem of when the species colonised the island (<code>stem = "island_presence</code>), either 'min' or 'asr' as in extract_island_species(). When <code>stem = "island_presence"</code> the reconstructed node states are used to determine the stem age.</h1>
      <small class="dont-index">Source: <a href="https://github.com/joshwlambert/DAISIEprep/blob/master/R/extract_stem_age.R" class="external-link"><code>R/extract_stem_age.R</code></a></small>
      <div class="d-none name"><code>extract_stem_age.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extracts the stem age from the phylogeny when the a species is known to
belong to a genus but is not itself in the phylogeny and there are members
of the same genus are in the phylogeny. The stem age can either be for the
genus (or several genera) in the tree (<code>stem = "genus"</code>) or use an extraction
algorithm to find the stem of when the species colonised the island
(<code>stem = "island_presence</code>), either 'min' or 'asr' as in
extract_island_species(). When <code>stem = "island_presence"</code>
the reconstructed node states are used
to determine the stem age.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">extract_stem_age</span><span class="op">(</span><span class="va">genus_name</span>, <span class="va">phylod</span>, <span class="va">stem</span>, extraction_method <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-genus-name">genus_name<a class="anchor" aria-label="anchor" href="#arg-genus-name"></a></dt>
<dd><p>Character string of genus name to be matched with a genus
name from the tip labels in the phylogeny</p></dd>


<dt id="arg-phylod">phylod<a class="anchor" aria-label="anchor" href="#arg-phylod"></a></dt>
<dd><p>A <code>phylo4d</code> object from the package <code>phylobase</code> containing
phylogenetic and endemicity data for each species.</p></dd>


<dt id="arg-stem">stem<a class="anchor" aria-label="anchor" href="#arg-stem"></a></dt>
<dd><p>Character string, either "genus" or "island_presence". The former
will extract the stem age of the genussbased on the genus name provided, the
latter will extract the stem age based on the ancestral presence on the
island either based on the "min" or "asr" extraction algorithms.</p></dd>


<dt id="arg-extraction-method">extraction_method<a class="anchor" aria-label="anchor" href="#arg-extraction-method"></a></dt>
<dd><p>A character string specifying whether the
colonisation time extracted is the minimum time (<code>min</code>) (before the present),
or the most probable time under ancestral state reconstruction (<code>asr</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Numeric</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># In this example the parrot clade is the genus of interest only the parrots</span></span></span>
<span class="r-in"><span><span class="co"># are endemic to the island and all the passerines are not on the island</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rcoal</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"passerine_a"</span>, <span class="st">"passerine_b"</span>, <span class="st">"passerine_c"</span>, <span class="st">"passerine_d"</span>, <span class="st">"passerine_e"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"passerine_f"</span>, <span class="st">"parrot_a"</span>, <span class="st">"parrot_b"</span>, <span class="st">"parrot_c"</span>, <span class="st">"passerine_j"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4-methods.html" class="external-link">phylo4</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"not_present"</span>, <span class="st">"endemic"</span>, <span class="st">"endemic"</span>, <span class="st">"endemic"</span>, <span class="st">"not_present"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">tree</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">endemicity_status</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">DAISIEprep</span><span class="fu">::</span><span class="fu"><a href="plot_phylod.html">plot_phylod</a></span><span class="op">(</span><span class="va">phylod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="extract_stem_age-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># the species 'parrot_a' is removed and becomes the missing species we want</span></span></span>
<span class="r-in"><span><span class="co"># to the know the stem age for</span></span></span>
<span class="r-in"><span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/subset-methods.html" class="external-link">subset</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">phylod</span>, tips.exclude <span class="op">=</span> <span class="st">"parrot_a"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">DAISIEprep</span><span class="fu">::</span><span class="fu"><a href="plot_phylod.html">plot_phylod</a></span><span class="op">(</span><span class="va">phylod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="extract_stem_age-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">extract_stem_age</span><span class="op">(</span></span></span>
<span class="r-in"><span>  genus_name <span class="op">=</span> <span class="st">"parrot"</span>,</span></span>
<span class="r-in"><span>  phylod <span class="op">=</span> <span class="va">phylod</span>,</span></span>
<span class="r-in"><span>  stem <span class="op">=</span> <span class="st">"island_presence"</span>,</span></span>
<span class="r-in"><span>  extraction_method <span class="op">=</span> <span class="st">"min"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7648553</span>
<span class="r-in"><span><span class="co"># here we use the extraction_method = "asr" which requires ancestral node</span></span></span>
<span class="r-in"><span><span class="co"># states in the tree.</span></span></span>
<span class="r-in"><span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu"><a href="add_asr_node_states.html">add_asr_node_states</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  phylod <span class="op">=</span> <span class="va">phylod</span>,</span></span>
<span class="r-in"><span>  asr_method <span class="op">=</span> <span class="st">"parsimony"</span>,</span></span>
<span class="r-in"><span>  tie_preference <span class="op">=</span> <span class="st">"mainland"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">DAISIEprep</span><span class="fu">::</span><span class="fu"><a href="plot_phylod.html">plot_phylod</a></span><span class="op">(</span><span class="va">phylod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="extract_stem_age-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">extract_stem_age</span><span class="op">(</span></span></span>
<span class="r-in"><span>  genus_name <span class="op">=</span> <span class="st">"parrot"</span>,</span></span>
<span class="r-in"><span>  phylod <span class="op">=</span> <span class="va">phylod</span>,</span></span>
<span class="r-in"><span>  stem <span class="op">=</span> <span class="st">"island_presence"</span>,</span></span>
<span class="r-in"><span>  extraction_method <span class="op">=</span> <span class="st">"asr"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.721423</span>
<span class="r-in"><span><span class="co"># lastly we extract the stem age based on the genus name</span></span></span>
<span class="r-in"><span><span class="fu">extract_stem_age</span><span class="op">(</span></span></span>
<span class="r-in"><span>  genus_name <span class="op">=</span> <span class="st">"parrot"</span>,</span></span>
<span class="r-in"><span>  phylod <span class="op">=</span> <span class="va">phylod</span>,</span></span>
<span class="r-in"><span>  stem <span class="op">=</span> <span class="st">"genus"</span>,</span></span>
<span class="r-in"><span>  extraction_method <span class="op">=</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7648553</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Luis Valente, Pedro Santos Neves, Lizzie Roeble, Theo Pannetier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>


<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>DAISIEprep Tutorial • DAISIEprep</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DAISIEprep Tutorial">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAISIEprep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorial</h6></li>
    <li><a class="dropdown-item" href="../articles/Tutorial.html">DAISIEprep Tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Forcing nonendemic singletons</h6></li>
    <li><a class="dropdown-item" href="../articles/Forcing_nonendemic_singleton.html">Forcing non-endemic singletons: solutions and limitations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extracting multi-tip species</h6></li>
    <li><a class="dropdown-item" href="../articles/Multi_tip_extraction.html">Extracting species with multiple tips in the phylogeny</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extending ASR</h6></li>
    <li><a class="dropdown-item" href="../articles/Extending_asr.html">Extending DAISIEprep ASR models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6></li>
    <li><a class="dropdown-item" href="../articles/Sensitivity.html">Sensitivity</a></li>
    <li><a class="dropdown-item" href="../articles/Performance.html">Performance</a></li>
    <li><a class="dropdown-item" href="../articles/DAISIE_FAQs.html">DAISIE FAQs</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joshwlambert/DAISIEprep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>DAISIEprep Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joshwlambert/DAISIEprep/blob/master/vignettes/Tutorial.Rmd" class="external-link"><code>vignettes/Tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>Tutorial.Rmd</code></div>
    </div>

    
    
<p>In this tutorial, the main features of DAISIEprep are explained.
DAISIEprep (Lambert et al.) is an R package that facilitates formatting
of data for subsequent use in DAISIE.</p>
<p><img src="../reference/figures/logo.png"></p>
<p>A typical DAISIEprep pipeline is as follows:</p>
<ol style="list-style-type: decimal">
<li>Load phylogenetic tree and island distribution data (endemic,
nonendemic to the island) into R.</li>
<li>Assign an island endemicity status (endemic, nonendemic, not
present) to each of the species on the tree.</li>
<li>Automatically extract times of colonisation of the island and
diversification within the island from the phylogenies.</li>
<li>Add any missing species.</li>
<li>Format data for DAISIE.</li>
</ol>
<div class="section level3">
<h3 id="the-tutorial-is-divided-into-3-sections">The tutorial is divided into 3 sections:<a class="anchor" aria-label="anchor" href="#the-tutorial-is-divided-into-3-sections"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Single phylogeny example</strong> - Learn how to extract
and format island data for running DAISIE based on a single phylogenetic
tree.</p></li>
<li><p><strong>Multiple phylogenies example</strong> - Learn how to
extract and format island data for running DAISIE based for cases where
you have multiple phylogenetic trees (e.g. different phylogenies from
different literature sources including different island
lineages).</p></li>
<li><p><strong>Adding missing species</strong> - How to add missing
species, lineages, etc, to your DAISIE data list.</p></li>
</ol>
<p>Load the required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshwlambert/DAISIEprep" class="external-link">DAISIEprep</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fmichonneau/phylobase" class="external-link">phylobase</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.amazon.com/Integration-Manipulation-Visualization-Phylogenetic-Computational-ebook/dp/B0B5NLZR1Z/" class="external-link">ggtree</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/GuangchuangYu/ggimage" class="external-link">ggimage</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">castor</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sec-single">1. Single Phylogeny Example<a class="anchor" aria-label="anchor" href="#sec-single"></a>
</h2>
<div class="section level4">
<h4 id="in-this-section-we-demonstrate-a-simple-example-of-extracting-and-formatting-data-from-a-single-phylogeny--we-use-an-example-phylogeny-of-an-imaginary-clade-of-plant-species-which-includes-2-species-occurring-on-an-example-focal-island-">In this section we demonstrate a simple example of extracting and
formatting data from a single phylogeny. We use an example phylogeny of
an imaginary clade of plant species, which includes 2 species occurring
on an example focal island.<a class="anchor" aria-label="anchor" href="#in-this-section-we-demonstrate-a-simple-example-of-extracting-and-formatting-data-from-a-single-phylogeny--we-use-an-example-phylogeny-of-an-imaginary-clade-of-plant-species-which-includes-2-species-occurring-on-an-example-focal-island-"></a>
</h4>
</div>
<div class="section level3">
<h3 id="load-the-phylogeny">Load the phylogeny<a class="anchor" aria-label="anchor" href="#load-the-phylogeny"></a>
</h3>
<p>First we load our example phylogeny (file included in the
<code>DAISIEprep</code> R package, that is why we use this complicated
code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"plant_phylo"</span><span class="op">)</span></span></code></pre></div>
<p>For your own trees you would normally use something like
<code>read.tree(),</code> <code><a href="https://rdrr.io/pkg/ape/man/read.nexus.html" class="external-link">read.nexus()</a></code>, <code><a href="https://rdrr.io/r/base/load.html" class="external-link">load()</a></code>
specifying the path to your tree file or R phylo object).</p>
<p>Object <code>plant_phylo</code> we have just loaded is a “typical”
phylogeny of class ‘phylo’.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">plant_phylo</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "phylo"</span></span></code></pre></div>
<p>Let’s plot the phylogeny in order to visualise it. As you can see, it
has different species of plants.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">plant_phylo</span>, underscore <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot%20phylo-1.png" width="672" style="display: block; margin: auto;"></p>
<p><strong>Important: <code>DAISIEprep</code> requires the tip labels
(taxon names) in the phylogeny to be formatted as genus name and species
name separated by an underscore (e.g. “Canis_lupus” or
“Plant_a”).</strong> They can also optionally have tags appended after
the species name (separated by underscore, e.g. “Canis_lupus_123”;
“Plant_a_123”; “Canis_lupus_familiaris_123”), which is common if there
are multiple tips in the phylogeny for a single species, e.g. when
multiple populations or multiple subspecies have been sampled. Samples
with the same Genus_species name on the tip label will be considered to
be of the <strong>same species</strong>, even if they have subsequent
sampling or subspecies tags.</p>
<p>So in the example above we have turned on the option
<code>underscore = TRUE</code> in the plotting function, so that you can
see that there is an underscore between the words on the tip names. In
this case, “Plant” can be viewed as the genus epithet in a binomial
name, and the letters after the underscore as the species epithet (for
instance “Genus_speciesA” or in this case “Plant_a”).</p>
<p><strong>Currently DAISIEprep does not deal well with island species
that are not monophyletic, because it does not know how to make a
decision on how many colonisation events to infer. This needs some
expert input from the user (e.g. you may consider that some tips are
incorrectly placed, or perhaps the species really is polyphyletic). So
we recommend you make decisions for these cases before running the
package.</strong></p>
</div>
<div class="section level3">
<h3 id="convert-the-phylogeny-to-phylo4">Convert the phylogeny to phylo4<a class="anchor" aria-label="anchor" href="#convert-the-phylogeny-to-phylo4"></a>
</h3>
<p>The next step is to convert the phylogeny into a <code>phylo4</code>
class, defined in the package <code>phylobase</code>. This allows users
to easily work with data for each tip in the phylogeny, for example
whether they are endemic to the island or not.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plant_phylo</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4-methods.html" class="external-link">phylo4</a></span><span class="op">(</span><span class="va">plant_phylo</span><span class="op">)</span></span>
<span><span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">plant_phylo</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/convert%20phylo%20to%20phylo4-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Now we have a phylogeny in the <code>phylo4</code> format to which we
can easily append data.</p>
</div>
<div class="section level3">
<h3 id="add-endemicity-statuses">Add endemicity statuses<a class="anchor" aria-label="anchor" href="#add-endemicity-statuses"></a>
</h3>
<p>We now need to add to the phylogeny information about which species
are present on the island and what their endemicity statuses are.
Species that occur on the island can either be “endemic” (occur only on
the island), or “nonendemic” (occur on the island but also on another
landmass).</p>
<p>In the example plant phylogeny we are running here, only two plant
species in the phylogeny occur on the island. One of them, “Plant_i”, is
endemic to the island. The other, “Plant_g”, is a nonendemic species.
Let’s create a data frame linking each island species to their
endemicity status. (<strong>For your own data, you can create this table
in a separate editor and then load it into R as a
data.frame</strong>).</p>
<p><strong>We recommend using the true endemicity status (“endemic” or
“nonendemic”) for all cases. However, there is an exception: cases where
one or more species from an endemic island radiation have colonised the
mainland. These species are embedded in the island radiation, have
evolved on the island, and later expanded their range to the mainland.
Technically these species are nonendemic because they are found on both
the island and mainland. However, from the perspective of the DAISIE
model, we recommend scoring such species as endemic. This is because
scoring them as nonendemic may lead to complex biogeographical
reconstruction that may end up breaking up an endemic island radiation
into multiple lineages; and also because this may lead to an
underestimation of the speciation rates on the island. By classifying
those species as endemic we can avoid these problems. </strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  tip_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Plant_i"</span>, <span class="st">"Plant_g"</span><span class="op">)</span>,</span>
<span>  tip_endemicity_status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"endemic"</span>, <span class="st">"nonendemic"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">island_species</span></span>
<span><span class="co">#&gt;   tip_labels tip_endemicity_status</span></span>
<span><span class="co">#&gt; 1    Plant_i               endemic</span></span>
<span><span class="co">#&gt; 2    Plant_g            nonendemic</span></span></code></pre></div>
<p>The <code>island_species</code> data frame produced above specifies
the island endemicity status of only the species that are found on the
island. We can generate the rest of the endemicity statuses for those
species that are in the phylogeny but are not present on the island
using <code><a href="../reference/create_endemicity_status.html">create_endemicity_status()</a></code>. All such species will be
assigned “not_present”.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_endemicity_status.html">create_endemicity_status</a></span><span class="op">(</span></span>
<span>  phylo <span class="op">=</span> <span class="va">plant_phylo</span>,</span>
<span>  island_species <span class="op">=</span> <span class="va">island_species</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next, we can add the endemicity data to our phylogenetic tree using
features of <code>phylo4d</code> class, again from the
<code>phylobase</code> package. This call is designed for phylogenetic
and trait data to be stored together. The endemicity status needs to be
in a data frame format in order for this to work correctly.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">plant_phylo</span>, <span class="va">endemicity_status</span><span class="op">)</span></span></code></pre></div>
<p>We can now visualise our phylogeny with the island endemicity
statuses plotted at the tips. This uses the <code>ggtree</code> and
<code>ggplot2</code> packages.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_phylod.html">plot_phylod</a></span><span class="op">(</span>phylod <span class="op">=</span> <span class="va">phylod</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot%20phylogeny%20with%20tip%20data-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="create-island_tbl-object">Create island_tbl object<a class="anchor" aria-label="anchor" href="#create-island_tbl-object"></a>
</h3>
<p>Now that we know the tips in the phylogeny that are present on the
island, we can extract their colonisation and branching times, to form
our island community data set that can be used in the
<code>DAISIE</code> R package to fit likelihood models of island
colonisation and diversification. Before we extract species, we will
first create an object to store all of the island colonists’
information. This uses the <code>island_tbl</code> class introduced in
this package (<code>DAISIEprep</code>). This <code>island_tbl</code>
object can then easily be converted to a DAISIE data list using the
function <code>create_daisie_data</code> (more information on this
below).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/island_tbl.html">island_tbl</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">island_tbl</span></span>
<span><span class="co">#&gt; Class:  Island_tbl </span></span>
<span><span class="co">#&gt; [1] clade_name      status          missing_species col_time       </span></span>
<span><span class="co">#&gt; [5] col_max_age     branching_times min_age         species        </span></span>
<span><span class="co">#&gt; [9] clade_type     </span></span>
<span><span class="co">#&gt; &lt;0 rows&gt; (or 0-length row.names)</span></span></code></pre></div>
<p>We can see that this is an object containing an empty data frame. In
order to fill this data frame with information on the island
colonisation and diversification events we can run the steps below.</p>
</div>
<div class="section level3">
<h3 id="extract-data-with-the-daisieprep-min-algorithm">Extract data with the <code>DAISIEprep</code> “min” algorithm<a class="anchor" aria-label="anchor" href="#extract-data-with-the-daisieprep-min-algorithm"></a>
</h3>
<p>The function <code><a href="../reference/extract_island_species.html">extract_island_species()</a></code> is the main
function in <code>DAISIEprep</code> to extract data from a phylogeny. In
the example below, we use the “min” extraction algorithm. The “min”
algorithm extracts island community data with the assumptions of the
DAISIE model (i.e. no back-colonisation from the island to the
mainland).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span></span>
<span>  phylod <span class="op">=</span> <span class="va">phylod</span>,</span>
<span>  extraction_method <span class="op">=</span> <span class="st">"min"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">island_tbl</span></span>
<span><span class="co">#&gt; Class:  Island_tbl </span></span>
<span><span class="co">#&gt;   clade_name     status missing_species   col_time col_max_age branching_times</span></span>
<span><span class="co">#&gt; 1    Plant_g nonendemic               0 0.38003405       FALSE              NA</span></span>
<span><span class="co">#&gt; 2    Plant_i    endemic               0 0.04960523       FALSE              NA</span></span>
<span><span class="co">#&gt;   min_age species clade_type</span></span>
<span><span class="co">#&gt; 1      NA Plant_g          1</span></span>
<span><span class="co">#&gt; 2      NA Plant_i          1</span></span></code></pre></div>
<p>Each row in the <code>island_tbl</code> corresponds to a separate
colonisation of the island. <strong>In this case, two colonist lineages
were identified using the ‘min’ extraction algorithm, one endemic and
another nonendemic.</strong></p>
</div>
<div class="section level3">
<h3 id="extract-data-with-the-daisieprep-asr-algorithm">Extract data with the <code>DAISIEprep</code> “asr” algorithm<a class="anchor" aria-label="anchor" href="#extract-data-with-the-daisieprep-asr-algorithm"></a>
</h3>
<p>The “min” algorithm sometimes does a good job, but we recommend using
the “asr” algorithm instead when back-colonisation events are present in
the data (for example, one species within a large endemic island
radiation colonised another island or mainland). To use the “asr”
algorithm to extract the most likely colonisations inferred in an
ancestral state reconstruction, we need to first estimate the
probability of the ancestors of the island species being present on the
island, in order to determine the time of colonisation. To do this, we
can fit one of many ancestral state reconstruction methods (see the
“Extending_asr” tutorial). Here we use maximum parsimony as it is a
simple method for reconstructing ancestral species areas (i.e. present
on the island, or not present on the island). First, we translate our
extant species endemicity status to a numeric representation of whether
that species is on the island, using the following function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_asr_node_states.html">add_asr_node_states</a></span><span class="op">(</span>phylod <span class="op">=</span> <span class="va">phylod</span>, asr_method <span class="op">=</span> <span class="st">"parsimony"</span><span class="op">)</span></span></code></pre></div>
<p>Now we can plot the phylogeny, which this time includes the node
labels for the presence/absence on the island in ancestral nodes.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_phylod.html">plot_phylod</a></span><span class="op">(</span>phylod <span class="op">=</span> <span class="va">phylod</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot%20phylogeny%20with%20tip%20and%20node%20data-1.png" width="672" style="display: block; margin: auto;"></p>
<p><br><br></p>
<p>Sidenote: if you are wondering what the probabilities are at each
node and whether this should influence your decision to pick a
preference for island or mainland when the likelihoods for each state
are equal, we can plot the probabilities at the nodes to visualise the
ancestral state reconstruction using
<code>plot_phylod(phylod = phylod, node_pies = TRUE)</code>.</p>
<p><br></p>
<p>Now we can extract island colonisation and diversification times from
the phylogeny using the reconstructed ancestral states of island
presence/absence.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span></span>
<span>  phylod <span class="op">=</span> <span class="va">phylod</span>,</span>
<span>  extraction_method <span class="op">=</span> <span class="st">"asr"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>If you are sure that all species you have scored as
“nonendemic” are the result of separate colonisation events (e.g., when
scoring the endemicity statuses you classified nonendemic species that
are embedded in an island radiation as endemic), then we recommend
setting <code>force_nonendemic_singleton = TRUE</code>. This will ensure
that all non-endemic species are extracted as separate lineages (avoids
groups of closely related non-endemic species being erroneously lumped
into an island clade due to the reconstruction).</strong></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span></span>
<span><span class="co">#&gt; Class:  Island_tbl </span></span>
<span><span class="co">#&gt;   clade_name  status missing_species  col_time col_max_age branching_times</span></span>
<span><span class="co">#&gt; 1    Plant_g endemic               0 0.7648553       FALSE    0.380034....</span></span>
<span><span class="co">#&gt;   min_age      species clade_type</span></span>
<span><span class="co">#&gt; 1      NA Plant_g,....          1</span></span></code></pre></div>
<p><strong>As you can see, in this case using the “asr” algorithm we
find a single colonisation of the island</strong>, as can be seen by the
fact that the <code>island_tbl</code> only has one row. The two island
species are inferred to result from a single colonisation of the island,
and the non-island species within that clade (“Plant_h”) is inferred to
have resulted from a back-colonisation from the island to the
mainland.</p>
<p><br></p>
</div>
<div class="section level3">
<h3 id="format-data-to-prepare-if-for-daisie">Format data to prepare if for DAISIE<a class="anchor" aria-label="anchor" href="#format-data-to-prepare-if-for-daisie"></a>
</h3>
<p>Now that we have the <code>island_tbl</code> we can convert this to
the DAISIE data list to be used by the DAISIE inference model.</p>
<p>To convert to the DAISIE data list (i.e. the input data of the DAISIE
inference model) we use <code><a href="../reference/create_daisie_data.html">create_daisie_data()</a></code>, providing the
<code>island_tbl</code> as input. We also need to specify:</p>
<ul>
<li>The age of the island or archipelago. Here we use an island age of
one million years (<code>island_age = 1</code>).</li>
<li>Whether the colonisation times extracted from the phylogenetic data
should be considered precise (<code>precise_col_time = TRUE</code>). We
will not discuss the details of this here, but briefly by setting this
to <code>TRUE</code> this will tell the DAISIE model that the
colonisation times are known. Setting
<code>precise_col_time = FALSE</code> will change tell the DAISIE model
that the colonisation time is uncertain and should interpret this as the
upper limit to the time of colonisation and integrate over the
uncertainty between this point and either the present time or to the
first branching point (either speciation or divergence into
subspecies).</li>
<li>The number of species in the mainland source pool. Here we set it to
100 (<code>num_mainland_species = 100</code>). This will be used to
calculate the number of species that could have potentially colonised
the island but have not. When we refer to the mainland pool, this does
not necessarily have to be a continent, it could be a different island
if the source of species immigrating to an island are largely from
another nearby island (a possible example of this could be Madagascar
being the source of species colonising Comoros). This information is
used by the DAISIE model to calculate the colonisation rate of the
island.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_daisie_data.html">create_daisie_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">island_tbl</span>,</span>
<span>  island_age <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num_mainland_species <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  precise_col_time <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Below we show two elements of the DAISIE data list produced. The
first element <code>data_list[[1]]</code> in every DAISIE data list is
the island community metadata, containing the island age and the number
of species in the mainland pool that did not leave descendants on the
island at the present day. This is important information for DAISIE
inference, as it is possible some mainland species colonised the island
but went extinct leaving no trace of their island presence.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $island_age</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $not_present</span></span>
<span><span class="co">#&gt; [1] 99</span></span></code></pre></div>
<p>Next is the first element containing information on island colonists
(every element <code>data_list[[x]]</code> in the list after the
metadata contains information on individual island colonists). This
contains the name of the colonist, the number of missing species, and
the branching times, which is a vector containing the age of the island,
the colonisation time and the times of any cladogenesis events.
Confusingly, it may be that the branching times vector contains no
branching times: when there are only two numbers in the vector these are
the island age followed by the colonisation time. Then there is the
stac, which stands for status of colonist. This is a number which tells
the DAISIE model how to identify the endemicity and colonisation
uncertainty of the island colonist (<a href="https://cran.r-project.org/package=DAISIE/vignettes/stac_key.html" class="external-link">these
are explained here if you are interested</a>). Lastly, the type1or2
defines which macroevolutionary regime an island colonist is in. By
macroevolutionary regime we mean the set of rates of colonisation,
speciation and extinction for that colonist. Most applications will
assume all island clades have the same regime and thus all are assigned
type 1. However, if there is <strong>a priori</strong> expectation that
one clade significantly different from the rest, e.g. the Galápagos
finches amongst the other terrestrial birds of the Galápagos archipelago
this clade can be set to type 2.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_list</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; $colonist_name</span></span>
<span><span class="co">#&gt; [1] "Plant_g"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $branching_times</span></span>
<span><span class="co">#&gt; [1] 1.0000000 0.7648553 0.3800341</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $stac</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $missing_species</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $type1or2</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>This data list is now ready to be used in the DAISIE maximum
likelihood inference model from the R package <code>DAISIE</code>. For
more information on the DAISIE data structures and their application in
the DAISIE models see this <a href="https://CRAN.R-project.org/package=DAISIE/vignettes/demo_optimize.html" class="external-link">vignette
on optimising parameters using DAISIE</a></p>
<p><br><br></p>
</div>
</div>
<div class="section level2">
<h2 id="multiple-phylogenies-example">2. Multiple phylogenies example<a class="anchor" aria-label="anchor" href="#multiple-phylogenies-example"></a>
</h2>
<div class="section level4">
<h4 id="in-this-section-we-demonstrate-an-empirical-use-case-of-the-package-on-the-avifauna-of-the-galápagos-archipelago-which-uses-several-phylogenies-for-different-island-colonists-">In this section we demonstrate an empirical use case of the package
on the avifauna of the Galápagos archipelago, which uses several
phylogenies for different island colonists.<a class="anchor" aria-label="anchor" href="#in-this-section-we-demonstrate-an-empirical-use-case-of-the-package-on-the-avifauna-of-the-gal%C3%A1pagos-archipelago-which-uses-several-phylogenies-for-different-island-colonists-"></a>
</h4>
<p>In the previous example we used a single phylogeny and extracted the
colonisation and branching events from it. However, it could be the case
that island species have been sampled in different phylogenies
(e.g. based on different markers, coming from different studies). Here
we look at an example for the terrestrial birds of the Galápagos
archipelago. There are 8 time-calibrated phylogenies to extract the
colonisation and diversification date from.</p>
<p>First, the phylogenies need to be loaded. The phylogenies are stored
in the DAISIEprep package so we can use the <code><a href="https://rdrr.io/r/utils/data.html" class="external-link">data()</a></code>
function, the phylogenies could alternatively be loaded using
<code><a href="https://rdrr.io/pkg/ape/man/read.nexus.html" class="external-link">read.nexus()</a></code> from the R package <code>ape</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">coccyzus_tree</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">columbiformes_tree</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">finches_tree</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mimus_tree</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">myiarchus_tree</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">progne_tree</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pyrocephalus_tree</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">setophaga_tree</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span></code></pre></div>
<p>Currently the phylogenies are loaded as S3 phylo objects, however, we
want to convert them into S4 phylobase objects.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coccyzus_tree</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">coccyzus_tree</span>, <span class="st">"phylo4"</span><span class="op">)</span></span>
<span><span class="va">columbiformes_tree</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">columbiformes_tree</span>, <span class="st">"phylo4"</span><span class="op">)</span></span>
<span><span class="va">finches_tree</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">finches_tree</span>, <span class="st">"phylo4"</span><span class="op">)</span></span>
<span><span class="va">mimus_tree</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">mimus_tree</span>, <span class="st">"phylo4"</span><span class="op">)</span></span>
<span><span class="va">myiarchus_tree</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">myiarchus_tree</span>, <span class="st">"phylo4"</span><span class="op">)</span></span>
<span><span class="va">progne_tree</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">progne_tree</span>, <span class="st">"phylo4"</span><span class="op">)</span></span>
<span><span class="va">pyrocephalus_tree</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">pyrocephalus_tree</span>, <span class="st">"phylo4"</span><span class="op">)</span></span>
<span><span class="va">setophaga_tree</span> <span class="op">&lt;-</span> <span class="fu">as</span><span class="op">(</span><span class="va">setophaga_tree</span>, <span class="st">"phylo4"</span><span class="op">)</span></span></code></pre></div>
<p>Now that all of the phylogenies are loaded we can inspect them. Let’s
start with the phylogeny for the genus <em>Coccyzus</em>:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coccyzus_tree</span>, cex <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>We can now create a table (data frame) of the <em>Coccyzus</em>
species that are on the island and their island endemicity status. This
table can be imported from a .csv or spreadsheet if you prefer.</p>
<p>The species names on the tree (tips labels) can be extracted using
<code>phylobase::tiplabels(coccyzus_tree)</code>. <strong>Make sure the
spelling matches exactly including any whitespace and underscores, and
the case of the names.</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  tip_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Coccyzus_melacoryphus_GALAPAGOS_L569A"</span>,</span>
<span>                 <span class="st">"Coccyzus_melacoryphus_GALAPAGOS_L571A"</span><span class="op">)</span>,</span>
<span>  tip_endemicity_status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nonendemic"</span>, <span class="st">"nonendemic"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>In order to not have to specify the endemicity status for all species
in the phylogeny and instead focus only on the island species, we can
easily assign the endemicity status for the rest of the species in the
tree. Using the <code>island_species</code> data frame produced above,
which specifies the island endemicity status of only the species that
are found on the island, we can generate the rest of the endemicity
statuses for those species that are in the phylogeny but are not present
on the island using <code><a href="../reference/create_endemicity_status.html">create_endemicity_status()</a></code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_endemicity_status.html">create_endemicity_status</a></span><span class="op">(</span></span>
<span>  phylo <span class="op">=</span> <span class="va">coccyzus_tree</span>,</span>
<span>  island_species <span class="op">=</span> <span class="va">island_species</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we have the endemicity status for all <em>Coccyzus</em> species
in the phylogeny, we can combine our phylogenetic data and endemicity
status data into a single data structure, the <code>phylo4d</code> class
from the <code>phylobase</code> R package, in exactly the same way as in
the <a href="#sec-single">single phylogeny example</a>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">coccyzus_tree</span>, <span class="va">endemicity_status</span><span class="op">)</span></span></code></pre></div>
<p>We can visualize the endemicity status of these species on the
tree.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_phylod.html">plot_phylod</a></span><span class="op">(</span>phylod <span class="op">=</span> <span class="va">phylod</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot%20coccyzus%20phylogeny%20with%20tip%20data-1.png" width="672" style="display: block; margin: auto;"></p>
<p><br></p>
<p>We are now ready to extract the relevant data from the phylogeny, to
produce the <code>island_tbl</code> for the <em>Coccyzus</em> tree. For
this step we use the “asr” method to extract the data which requires
inferring the ancestral geography of each species.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_asr_node_states.html">add_asr_node_states</a></span><span class="op">(</span></span>
<span>  phylod <span class="op">=</span> <span class="va">phylod</span>,</span>
<span>  asr_method <span class="op">=</span> <span class="st">"parsimony"</span>,</span>
<span>  tie_preference <span class="op">=</span> <span class="st">"mainland"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Plot the phylogeny with the node states:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_phylod.html">plot_phylod</a></span><span class="op">(</span>phylod <span class="op">=</span> <span class="va">phylod</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot%20phylogeny%20with%20tip%20and%20node%20data%20Coccyzus-1.png" width="672" style="display: block; margin: auto;"></p>
<p><br></p>
<p>Extract the data from the phylogeny:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span></span>
<span>  phylod <span class="op">=</span> <span class="va">phylod</span>,</span>
<span>  extraction_method <span class="op">=</span> <span class="st">"asr"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span></span>
<span><span class="co">#&gt; Class:  Island_tbl </span></span>
<span><span class="co">#&gt;              clade_name     status missing_species col_time col_max_age</span></span>
<span><span class="co">#&gt; 1 Coccyzus_melacoryphus nonendemic               0 1.789425        TRUE</span></span>
<span><span class="co">#&gt;   branching_times   min_age      species clade_type</span></span>
<span><span class="co">#&gt; 1              NA 0.5483906 Coccyzus....          1</span></span></code></pre></div>
<p>Instead of assigning the endemicity to each of the Galapagos bird
phylogenies and converting them to <code>phylo4d</code> objects (as we
did for <em>Coccyzus</em> above ), this has already been done and the
data objects have been prepared in advance and are ready to be used.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">coccyzus_phylod</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">columbiformes_phylod</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">finches_phylod</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mimus_phylod</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">myiarchus_phylod</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">progne_phylod</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pyrocephalus_phylod</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">setophaga_phylod</span>, package <span class="op">=</span> <span class="st">"DAISIEprep"</span><span class="op">)</span></span></code></pre></div>
<p>We now have the data for all 8 phylogenies in the correct format,
that is: a dated phylogeny, with tips written in “Genus_species” or
“Genus_species_TAG” format and with the island endemicity status
specified for all tips. We are now ready to extract the island data from
these trees using <code><a href="../reference/extract_island_species.html">extract_island_species()</a></code>, using the “asr”
algorithm.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span></span>
<span>  phylod <span class="op">=</span> <span class="va">coccyzus_phylod</span>,</span>
<span>  extraction_method <span class="op">=</span> <span class="st">"asr"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can now loop through the rest of the Galapagos phylogenies and add
them to the island data.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">galapagos_phylod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">coccyzus_phylod</span>, <span class="va">columbiformes_phylod</span>, <span class="va">finches_phylod</span>, <span class="va">mimus_phylod</span>,</span>
<span>  <span class="va">myiarchus_phylod</span>, <span class="va">progne_phylod</span>, <span class="va">pyrocephalus_phylod</span>, <span class="va">setophaga_phylod</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">phylod</span> <span class="kw">in</span> <span class="va">galapagos_phylod</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span></span>
<span>    phylod <span class="op">=</span> <span class="va">phylod</span>,</span>
<span>    extraction_method <span class="op">=</span> <span class="st">"asr"</span>,</span>
<span>    island_tbl <span class="op">=</span> <span class="va">island_tbl</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Warning in extract_species_asr(phylod = phylod, species_label = as.character(phylod@label[i]), : Root of the phylogeny is on the island so the colonisation</span></span>
<span><span class="co">#&gt;               time from the stem age cannot be collected, colonisation time</span></span>
<span><span class="co">#&gt;               will be set to infinite.</span></span></code></pre></div>
<p>The above example works, but it returns a warning message for the
Darwin’s finches (finches_phylod), because the root state of the
finches’ phylogeny is inferred to be present on the island, as there is
only a single mainland outgroup in the example phylogeny. This means
that the colonisation time will be extracted in <code>asr</code> as
infinite, and then when the island_tbl is converted into a DAISIE data
list this will become a colonist that could have colonised anywhere from
the island origin to the present. For this example this colonisation
time is not a problem, however, for empirical analyses it is recommended
to have many more mainland outgroup species in the tree to ensure the
ancestral state reconstructions can accurately detect the stem age of
the island clade.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_phylod.html">plot_phylod</a></span><span class="op">(</span><span class="va">finches_phylod</span><span class="op">)</span></span></code></pre></div>
<p><img src="Tutorial_files/figure-html/plot%20Darwins%20finches-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span></span>
<span><span class="co">#&gt; Class:  Island_tbl </span></span>
<span><span class="co">#&gt;                                 clade_name     status missing_species  col_time</span></span>
<span><span class="co">#&gt; 1                    Coccyzus_melacoryphus nonendemic               0 1.7894251</span></span>
<span><span class="co">#&gt; 2 Zenaida_galapagoensis_GALAPAGOS_AF251531    endemic               0 3.1933725</span></span>
<span><span class="co">#&gt; 3                                    C_fus    endemic               0       Inf</span></span>
<span><span class="co">#&gt; 4      Mimus_macdonaldi_GALAPAGOS_KF411075    endemic               0 4.4853284</span></span>
<span><span class="co">#&gt; 5                         M_magnirostris_1    endemic               0 0.8544740</span></span>
<span><span class="co">#&gt; 6           Progne_modesta_GALAPAGOS_L573A    endemic               0 3.0014710</span></span>
<span><span class="co">#&gt; 7      Pyrocephalus_dubius_Galapagos_cas01    endemic               0 9.3661766</span></span>
<span><span class="co">#&gt; 8             D_petechia_Galapagos_sancris    endemic               0 0.1400011</span></span>
<span><span class="co">#&gt;   col_max_age branching_times   min_age      species clade_type</span></span>
<span><span class="co">#&gt; 1        TRUE              NA 0.5483906 Coccyzus....          1</span></span>
<span><span class="co">#&gt; 2       FALSE    0.050253....        NA Zenaida_....          1</span></span>
<span><span class="co">#&gt; 3       FALSE    1.322705....        NA C_fus, C....          1</span></span>
<span><span class="co">#&gt; 4       FALSE    3.680027....        NA Mimus_ma....          1</span></span>
<span><span class="co">#&gt; 5       FALSE    0.222988....        NA M_magnir....          1</span></span>
<span><span class="co">#&gt; 6       FALSE    0.387570....        NA Progne_m....          1</span></span>
<span><span class="co">#&gt; 7       FALSE    0.825248....        NA Pyroceph....          1</span></span>
<span><span class="co">#&gt; 8       FALSE    0.057946....        NA D_petech....          1</span></span></code></pre></div>
<p>Now we have the <code>island_tbl</code> with all the data on the
colonisation, branching times, and composition of each island colonist.
We can convert it to a DAISIE data list to be applied to the DAISIE
inference model. Here we use an island age of the Galápagos archipelago
of 4 million years, and assume that all colonisation time extracted are
precise. Whether they are in fact precise is not covered in this
tutorial, and when using this pipeline to process different data it may
be worth toggling the <code>precise_col_time</code> to
<code>FALSE</code> to check whether assuming uncertainty in colonisation
times influences conclusions.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_daisie_data.html">create_daisie_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">island_tbl</span>,</span>
<span>  island_age <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  num_mainland_species <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  precise_col_time <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The <code>data_list</code> produced above is now ready for your
DAISIE analyses! <a href="https://CRAN.R-project.org/package=DAISIE/vignettes/demo_optimize.html" class="external-link">See
vignette on optimising parameters using DAISIE</a></p>
</div>
</div>
<div class="section level2">
<h2 id="adding-missing-species">3. Adding missing species<a class="anchor" aria-label="anchor" href="#adding-missing-species"></a>
</h2>
<p>It is often the case that phylogenetic data is not available for some
island species or even entire lineages present in the island community.
But we can still include these species in our DAISIE analyses.
Furthermore, even in the cases where a dated phylogeny does exist, it
may not be open-source and available to use for the extraction. In the
latter cases, it may be possible to know the stem age or crown age if
reported in the literature with the published phylogeny. This section
explains how to use the tools that <code>DAISIEprep</code> provides in
order to handle missing data, and generally to handle species that are
missing and need to be input into the data manually.</p>
<p>For this section, as with the previous section, the core data
structure we are going to work with is the <code>island_tbl</code>. We
will use the <code>island_tbl</code> for the Galápagos birds produced in
the last section.</p>
<div class="section level3">
<h3 id="adding-missing-species-to-an-island-clade-that-has-been-sampled-in-the-phylogeny">3.1 Adding missing species to an island clade that has been sampled
in the phylogeny<a class="anchor" aria-label="anchor" href="#adding-missing-species-to-an-island-clade-that-has-been-sampled-in-the-phylogeny"></a>
</h3>
<p>This option is for cases in which a clade has been sampled in the
phylogeny, and at least 1 colonisation or 1 branching time is available,
but 1 or more species were not sampled. For this example, we imagine
that 2 species of Galápagos finch have not been sampled, and that we
want to add them as missing species to the Galápagos finch clade that is
sampled in the phylogeny. The finches have the clade name “C_fus” in the
<code>island_tbl</code> (third row). To assign 2 missing species to this
clade we use following code:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_missing_species.html">add_missing_species</a></span><span class="op">(</span></span>
<span>  island_tbl <span class="op">=</span> <span class="va">island_tbl</span>,</span>
<span>  <span class="co"># num_missing_species equals total species missing</span></span>
<span>  num_missing_species <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="co"># name of a sampled species you want to "add" the missing to</span></span>
<span>  <span class="co"># it can be any in the clade</span></span>
<span>  species_to_add_to <span class="op">=</span> <span class="st">"C_fus"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The argument <code>species_to_add_to</code> uses a representative
sampled species from that island clade to work out which colonist in the
<code>island_tbl</code> to assign the specified number of missing
species (<code>num_missing_species</code>) to. In this case we used the
species in the clade name, however, this could also have been any
sampled species from the clade, which include:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span><span class="op">@</span><span class="va">island_tbl</span><span class="op">$</span><span class="va">species</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;  [1] "C_fus"  "C_oliv" "P_cras" "G_diff" "C_pau"  "C_par"  "C_psi"  "C_hel" </span></span>
<span><span class="co">#&gt;  [9] "C_pal"  "G_sep"  "G_for"  "G_ful"  "G_con"  "G_mag"  "G_scan"</span></span></code></pre></div>
<p>With the new missing species added to the <code>island_tbl</code> we
can repeat the conversion steps above using
<code><a href="../reference/create_daisie_data.html">create_daisie_data()</a></code> to produce data accepted by the DAISIE
model.</p>
</div>
<div class="section level3">
<h3 id="adding-a-lineage-with-just-one-species-on-the-island-singleton-when-a-phylogeny-is-not-available-for-the-lineage-but-a-colonisation-time-estimate-exists">3.2 Adding a lineage with just one species on the island (singleton)
when a phylogeny is not available for the lineage, but a colonisation
time estimate exists<a class="anchor" aria-label="anchor" href="#adding-a-lineage-with-just-one-species-on-the-island-singleton-when-a-phylogeny-is-not-available-for-the-lineage-but-a-colonisation-time-estimate-exists"></a>
</h3>
<p>This option is for adding <strong>a singleton lineage (just one
species on the island)</strong> when a phylogeny is not available to
conduct the extraction using <code><a href="../reference/extract_island_species.html">extract_island_species()</a></code>, but
an estimate of the stem age of the island colonist is known from the
literature. In this case, we need to input all the information on the
lineage manually ourselves. For illustrative purposes, we use an
imaginary Galápagos bird lineage with 1 species, which is not in our
data set, and fabricate the time of colonisation.</p>
<p>The input needed are:</p>
<ul>
<li>
<code>island_tbl</code> to add to an existing
<code>island_tbl</code>
</li>
<li>
<code>clade_name</code> a name to represent the clade, can either be
a specific species from the clade or a genus name, or another name that
represent those species</li>
<li>
<code>status</code> either “endemic” or “nonendemic”</li>
<li>
<code>missing_species</code> <strong>In the case of a lineage with
just 1 species (i.e. not an island radiation) the number of missing
species to be specified here is zero, as by adding the colonist it
already counts as one automatically.</strong>
</li>
<li>
<code>col_time</code> the time of colonisation in million years
before the present</li>
<li>
<code>col_max_age</code> a boolean (TRUE/FALSE) on whether the
colonisation time is precise or should be considered a maximum upper
bound on the time of colonisation with some uncertainty</li>
<li>
<code>branching_times</code> the times an island clade has speciated
<em>in situ</em> on the island. If an island clade has not speciated
(i.e. is a singleton) this is NA. (In this it should be NA as the
example is for singleton lineages).</li>
<li>
<code>min_age</code> is the minimum lower bound time of
colonisation. This should only be used when the colonisation time added
is assumed to be an upper bound (<code>col_max_age</code>=TRUE)</li>
<li>
<code>species</code> a vector of species names contained within
colonist</li>
<li>
<code>clade_type</code> a number representing which set of rates the
colonist is assumed to be under, default is 1, as number greater than
one assume this clade is exceptionally different in its colonisation and
diversification dynamics</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_island_colonist.html">add_island_colonist</a></span><span class="op">(</span></span>
<span>  island_tbl <span class="op">=</span> <span class="va">island_tbl</span>,</span>
<span>  clade_name <span class="op">=</span> <span class="st">"Bird_a"</span>,</span>
<span>  status <span class="op">=</span> <span class="st">"endemic"</span>,</span>
<span>  <span class="co"># clade with just 1 species, missing_species = 0</span></span>
<span>  <span class="co"># because adding the lineage already counts as 1</span></span>
<span>  missing_species <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  col_time <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  col_max_age <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  branching_times <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  min_age <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Bird_a"</span>,</span>
<span>  clade_type <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With the new missing species added to the <code>island_tbl</code> we
can repeat the conversion steps above using
<code><a href="../reference/create_daisie_data.html">create_daisie_data()</a></code> to produce data accepted by the DAISIE
model.</p>
</div>
<div class="section level3">
<h3 id="adding-a-lineage-with-2-or-more-species-on-the-island-when-a-phylogeny-is-not-available-for-the-lineage-but-a-colonisation-time-estimate-exists">3.3 Adding a lineage with 2 or more species on the island when a
phylogeny is not available for the lineage, but a colonisation time
estimate exists<a class="anchor" aria-label="anchor" href="#adding-a-lineage-with-2-or-more-species-on-the-island-when-a-phylogeny-is-not-available-for-the-lineage-but-a-colonisation-time-estimate-exists"></a>
</h3>
<p>Taking the example above in <code>3.2</code>, but when the
<strong>lineage has 2 or more species</strong>. In this case, we we use
an imaginary Galápagos bird lineage with 3 species, which is not in our
data set, and fabricate the time of colonisation.</p>
<p>The input needed are:</p>
<ul>
<li>
<code>island_tbl</code> to add to an existing
<code>island_tbl</code>
</li>
<li>
<code>clade_name</code> a name to represent the clade, can either be
a specific species from the clade or a genus name, or another name that
represent those species</li>
<li>
<code>status</code> either “endemic” or “nonendemic”</li>
<li>
<code>missing_species</code> <strong>The number of missing species
in this case should be <code>n-1</code>, because adding the lineage
manually already counts as 1.</strong>
</li>
<li>
<code>col_time</code> the time of colonisation in million years
before the present</li>
<li>
<code>col_max_age</code> a boolean (TRUE/FALSE) on whether the
colonisation time is precise or should be considered a maximum upper
bound on the time of colonisation with some uncertainty</li>
<li>
<code>branching_times</code> the times an island clade has speciated
<em>in situ</em> on the island. If an island clade has not speciated
(i.e. is a singleton) this is NA.</li>
<li>
<code>min_age</code> is the minimum lower bound time of
colonisation. This should be used when an upper bound for colonisation
time is known but is different from the crown age.</li>
<li>
<code>species</code> a vector of species names contained within
colonist</li>
<li>
<code>clade_type</code> a number representing which set of rates the
colonist is assumed to be under, default is 1, as number greater than
one assume this clade is exceptionally different in its colonisation and
diversification dynamics</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_island_colonist.html">add_island_colonist</a></span><span class="op">(</span></span>
<span>  island_tbl <span class="op">=</span> <span class="va">island_tbl</span>,</span>
<span>  clade_name <span class="op">=</span> <span class="st">"Bird_b"</span>,</span>
<span>  status <span class="op">=</span> <span class="st">"endemic"</span>,</span>
<span>  <span class="co"># the total species is 3 and all are missing</span></span>
<span>  <span class="co"># but we add missing_species = 2 because</span></span>
<span>  <span class="co"># adding the lineage already counts as 1</span></span>
<span>  missing_species <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  col_time <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  col_max_age <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  branching_times <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  min_age <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  clade_type <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bird_b"</span>, <span class="st">"Bird_c"</span>, <span class="st">"Bird_d"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With the new missing species added to the <code>island_tbl</code> we
can repeat the conversion steps above using
<code><a href="../reference/create_daisie_data.html">create_daisie_data()</a></code> to produce data accepted by the DAISIE
model.</p>
</div>
<div class="section level3">
<h3 id="adding-a-lineage-when-a-phylogeny-is-not-available-for-the-lineage-and-no-colonisation-estimate-is-available-">3.4 Adding a lineage when a phylogeny is not available for the
lineage, and no colonisation estimate is available.<a class="anchor" aria-label="anchor" href="#adding-a-lineage-when-a-phylogeny-is-not-available-for-the-lineage-and-no-colonisation-estimate-is-available-"></a>
</h3>
<p>Taking the examples above in <code>3.2</code> and <code>3.3</code>
but assuming we did not have any phylogenetic data or colonisation time
estimate for the island clade, we could again insert the species as
missing but this time not give the colonisation time. When this colonist
later gets processed by the DAISIE inference model it will be assumed it
colonised the island any time between the island’s formation (in the
case of the Galápagos four million years ago) and the present.</p>
<ul>
<li>
<code>missing_species</code> <strong>In the case of a lineage with
just 1 species (i.e. not an island radiation) the number of missing
species is zero, as by adding the colonist it already counts as one
automatically. In the case of an island clade of more than one species,
the number of missing species in this case should be
<code>n-1</code>.</strong>
</li>
</ul>
<p>Example for adding lineage with 1 species:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_island_colonist.html">add_island_colonist</a></span><span class="op">(</span></span>
<span>  island_tbl <span class="op">=</span> <span class="va">island_tbl</span>,</span>
<span>  clade_name <span class="op">=</span> <span class="st">"Bird_e"</span>,</span>
<span>  status <span class="op">=</span> <span class="st">"endemic"</span>,</span>
<span>  <span class="co"># clade with just 1 species, missing_species = 0</span></span>
<span>  <span class="co"># because adding the lineage already counts as 1</span></span>
<span>  missing_species <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  col_time <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  col_max_age <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  branching_times <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  min_age <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  clade_type <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Bird_e"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Example for adding lineage with 5 species:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_island_colonist.html">add_island_colonist</a></span><span class="op">(</span></span>
<span>  island_tbl <span class="op">=</span> <span class="va">island_tbl</span>,</span>
<span>  clade_name <span class="op">=</span> <span class="st">"Bird_f"</span>,</span>
<span>  status <span class="op">=</span> <span class="st">"endemic"</span>,</span>
<span>  <span class="co"># the total species is 5 and all are missing</span></span>
<span>  <span class="co"># but we add missing_species = 4 because</span></span>
<span>  <span class="co"># adding the lineage already counts as 1</span></span>
<span>  missing_species <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  col_time <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  col_max_age <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  branching_times <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  min_age <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  clade_type <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Bird_f"</span>, <span class="st">"Bird_g"</span>, <span class="st">"Bird_h"</span>,</span>
<span>              <span class="st">"Bird_i"</span>, <span class="st">"Bird_j"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>With the new missing species added to the <code>island_tbl</code> we
can repeat the conversion steps above using
<code><a href="../reference/create_daisie_data.html">create_daisie_data()</a></code> to produce data accepted by the DAISIE
model.</p>
</div>
<div class="section level3">
<h3 id="adding-a-lineage-when-a-phylogeny-is-not-available-for-the-entire-island-lineage-but-a-crown-age-or-minimum-colonisation-time-estimate-exists">3.5 Adding a lineage when a phylogeny is not available for the
entire island lineage, but a crown age or minimum colonisation time
estimate exists<a class="anchor" aria-label="anchor" href="#adding-a-lineage-when-a-phylogeny-is-not-available-for-the-entire-island-lineage-but-a-crown-age-or-minimum-colonisation-time-estimate-exists"></a>
</h3>
<p>Taking the example above in <code>3.2</code> but assuming we did not
have a colonisation time estimate, but we did have a crown age estimate
or an estimate for the minimum (latest) time the island could have been
colonised by the lineage. When this colonist later gets processed by the
DAISIE inference model it will be assumed it colonised the island any
time between the island’s formation (in the case of the Galápagos four
million years ago) and the crown or minimum age. In the example below we
assume a crown age of 2 million years.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_island_colonist.html">add_island_colonist</a></span><span class="op">(</span></span>
<span>  island_tbl <span class="op">=</span> <span class="va">island_tbl</span>,</span>
<span>  clade_name <span class="op">=</span> <span class="st">"Bird_k"</span>,</span>
<span>  status <span class="op">=</span> <span class="st">"endemic"</span>,</span>
<span>  missing_species <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  col_time <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  col_max_age <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  branching_times <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>  min_age <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Bird_k"</span>,</span>
<span>  clade_type <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in add_island_colonist(island_tbl = island_tbl, clade_name = "Bird_k",</span></span>
<span><span class="co">#&gt; : Adding a min_age is inconsistent with setting colonisation time to be precise</span></span>
<span><span class="co">#&gt; (col_max_age = FALSE). So in this case the min_age is ignored.</span></span></code></pre></div>
<p>With the new missing species added to the <code>island_tbl</code> we
can repeat the conversion steps above using
<code><a href="../reference/create_daisie_data.html">create_daisie_data()</a></code> to produce data accepted by the DAISIE
model.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_daisie_data.html">create_daisie_data</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">island_tbl</span>,</span>
<span>  island_age <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  num_mainland_species <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  precise_col_time <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Luis Valente, Pedro Santos Neves, Lizzie Roeble, Theo Pannetier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DAISIEprep">
<title>Performance â€¢ DAISIEprep</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Performance">
<meta property="og:description" content="DAISIEprep">
<meta property="og:image" content="https://joshwlambert.github.io/DAISIEprep/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DAISIEprep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Performance.html">Performance</a>
    <a class="dropdown-item" href="../articles/Tutorial.html">Tutorial</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="Performance_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Performance</h1>
            
      
      
      <div class="d-none name"><code>Performance.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://joshwlambert.github.io/DAISIEprep">DAISIEprep</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/" class="external-link">ape</a></span><span class="op">)</span>
<span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"microbenchmark"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Microbenchmark package needed for this vignette"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>First, we explain the setup of the performance analysis and then loop over this to run the analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">parameter_space</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>
  tree_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="fl">10000</span><span class="op">)</span>,
  prob_on_island <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span>,
  prob_endemic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span><span class="op">)</span>,
  sampling_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uniform"</span>, <span class="st">"clustered"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span>
  <span class="fl">1</span>,
  kind <span class="op">=</span> <span class="st">"Mersenne-Twister"</span>,
  normal.kind <span class="op">=</span> <span class="st">"Inversion"</span>,
  sample.kind <span class="op">=</span> <span class="st">"Rejection"</span>
<span class="op">)</span>
<span class="va">phylo</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rcoal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">tree_size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="co"># generate a set of unique tip labels that conform to standard</span>
<span class="va">tip_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">letters</span>, <span class="va">letters</span>, <span class="va">letters</span><span class="op">)</span>
<span class="va">tip_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">paste0</span>, <span class="va">tip_labels</span><span class="op">)</span>
<span class="va">tip_labels</span> <span class="op">&lt;-</span> <span class="va">tip_labels</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">parameter_space</span><span class="op">$</span><span class="va">tree_size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">tip_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"bird"</span>, <span class="va">tip_labels</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>
<span class="va">phylo</span><span class="op">$</span><span class="va">tip.label</span> <span class="op">&lt;-</span> <span class="va">tip_labels</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prob_not_present</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">prob_on_island</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="va">prob_endemic</span> <span class="op">&lt;-</span> 
  <span class="va">parameter_space</span><span class="op">$</span><span class="va">prob_endemic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">prob_on_island</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="va">prob_nonendemic</span> <span class="op">&lt;-</span> 
  <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">prob_endemic</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">prob_on_island</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>

<span class="co"># uniform sampling</span>
<span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"endemic"</span>, <span class="st">"nonendemic"</span>, <span class="st">"not_present"</span><span class="op">)</span>,
  size <span class="op">=</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">tree_size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
  replace <span class="op">=</span> <span class="cn">TRUE</span>,
  prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prob_endemic</span>, <span class="va">prob_nonendemic</span>, <span class="va">prob_not_present</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># clustered sampling</span>
<span class="co">#TODO</span></code></pre></div>
<p>As we are stochastically simulating the endemicity statuses of the species in the tree it may be that there is not an outgroup species not on the island in order to correctly extract the colonisation times from the stem age of the species or clade on the island. Therefore, we add an outgroup which we ensure is not present on the island.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phylo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_outgroup.html">add_outgroup</a></span><span class="op">(</span><span class="va">phylo</span><span class="op">)</span>
<span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not_present"</span>, <span class="va">endemicity_status</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">phylo</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">endemicity_status</span><span class="op">)</span><span class="op">)</span>
<span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_asr_node_states.html">add_asr_node_states</a></span><span class="op">(</span>
  phylod <span class="op">=</span> <span class="va">phylod</span>,
  asr_method <span class="op">=</span> <span class="st">"parsimony"</span>,
  tie_preference <span class="op">=</span> <span class="st">"island"</span>,
  earliest_col <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span>
  <span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span>
    phylod <span class="op">=</span> <span class="va">phylod</span>,
    extraction_method <span class="op">=</span> <span class="st">"min"</span>,
    island_tbl <span class="op">=</span> <span class="cn">NULL</span>,
    include_not_present <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span>,
  times <span class="op">=</span> <span class="fl">10L</span>
<span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">median_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">time</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">times_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">parameter_space</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span> <span class="op">{</span>
    
    <span class="co"># simulate phylogeny</span>
    <span class="va">phylo</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rcoal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">tree_size</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>
    
    
    <span class="co"># generate a set of unique tip labels that conform to standard</span>
    <span class="va">tip_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">letters</span>, <span class="va">letters</span>, <span class="va">letters</span><span class="op">)</span>
    <span class="va">tip_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">paste0</span>, <span class="va">tip_labels</span><span class="op">)</span>
    <span class="va">tip_labels</span> <span class="op">&lt;-</span> <span class="va">tip_labels</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">parameter_space</span><span class="op">$</span><span class="va">tree_size</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>
    <span class="va">tip_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"bird"</span>, <span class="va">tip_labels</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>
    <span class="va">phylo</span><span class="op">$</span><span class="va">tip.label</span> <span class="op">&lt;-</span> <span class="va">tip_labels</span>
    <span class="va">prob_not_present</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">prob_on_island</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="va">prob_endemic</span> <span class="op">&lt;-</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">prob_endemic</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    <span class="va">prob_nonendemic</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">prob_endemic</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
    
    <span class="kw">if</span> <span class="op">(</span><span class="va">parameter_space</span><span class="op">$</span><span class="va">sampling_type</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"uniform"</span><span class="op">)</span> <span class="op">{</span>
      
      <span class="va">empty_island</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span>
      <span class="kw">while</span> <span class="op">(</span><span class="va">empty_island</span><span class="op">)</span> <span class="op">{</span>
        <span class="co"># generate tip states under uniform sampling</span>
        <span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>
          x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"endemic"</span>, <span class="st">"nonendemic"</span>, <span class="st">"not_present"</span><span class="op">)</span>,
          size <span class="op">=</span> <span class="va">parameter_space</span><span class="op">$</span><span class="va">tree_size</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,
          replace <span class="op">=</span> <span class="cn">TRUE</span>,
          prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">prob_endemic</span>, <span class="va">prob_nonendemic</span>, <span class="va">prob_not_present</span><span class="op">)</span>
        <span class="op">)</span>
        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">endemicity_status</span> <span class="op">!=</span> <span class="st">"not_present"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
          <span class="va">empty_island</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>
        <span class="op">}</span>
      <span class="op">}</span>
    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">parameter_space</span><span class="op">$</span><span class="va">sampling_type</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="st">"clustered"</span><span class="op">)</span> <span class="op">{</span>
      <span class="co"># clustered sampling</span>
      <span class="co">#TODO</span>
    <span class="op">}</span>
    
    <span class="co"># add not present outgroup</span>
    <span class="va">phylo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_outgroup.html">add_outgroup</a></span><span class="op">(</span><span class="va">phylo</span><span class="op">)</span>
    <span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not_present"</span>, <span class="va">endemicity_status</span><span class="op">)</span>
    
    <span class="co"># format data for DAISIEprep</span>
    <span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">phylo</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">endemicity_status</span><span class="op">)</span><span class="op">)</span>
    <span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_asr_node_states.html">add_asr_node_states</a></span><span class="op">(</span>
      phylod <span class="op">=</span> <span class="va">phylod</span>,
      asr_method <span class="op">=</span> <span class="st">"parsimony"</span>,
      tie_preference <span class="op">=</span> <span class="st">"island"</span>,
      earliest_col <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span>
    
    <span class="co"># run extraction</span>
    <span class="va">time</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span>
      <span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span>
        phylod <span class="op">=</span> <span class="va">phylod</span>,
        extraction_method <span class="op">=</span> <span class="st">"min"</span>,
        island_tbl <span class="op">=</span> <span class="cn">NULL</span>,
        include_not_present <span class="op">=</span> <span class="cn">FALSE</span>
      <span class="op">)</span>,
      times <span class="op">=</span> <span class="fl">10L</span>
    <span class="op">)</span>
    <span class="va">times</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">time</span><span class="op">$</span><span class="va">time</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="va">times_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">times</span>
<span class="op">}</span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joshua W. Lambert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Extracting species with multiple tips in the phylogeny • DAISIEprep</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extracting species with multiple tips in the phylogeny">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DAISIEprep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorial</h6></li>
    <li><a class="dropdown-item" href="../articles/Tutorial.html">DAISIEprep Tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Forcing nonendemic singletons</h6></li>
    <li><a class="dropdown-item" href="../articles/Forcing_nonendemic_singleton.html">Forcing non-endemic singletons: solutions and limitations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extracting multi-tip species</h6></li>
    <li><a class="dropdown-item" href="../articles/Multi_tip_extraction.html">Extracting species with multiple tips in the phylogeny</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Extending ASR</h6></li>
    <li><a class="dropdown-item" href="../articles/Extending_asr.html">Extending DAISIEprep ASR models</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Miscellaneous</h6></li>
    <li><a class="dropdown-item" href="../articles/Sensitivity.html">Sensitivity</a></li>
    <li><a class="dropdown-item" href="../articles/Performance.html">Performance</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/joshwlambert/DAISIEprep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extracting species with multiple tips in the phylogeny</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joshwlambert/DAISIEprep/blob/v1.0.0/vignettes/Multi_tip_extraction.Rmd" class="external-link"><code>vignettes/Multi_tip_extraction.Rmd</code></a></small>
      <div class="d-none name"><code>Multi_tip_extraction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshwlambert/DAISIEprep" class="external-link">DAISIEprep</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/emmanuelparadis/ape" class="external-link">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/fmichonneau/phylobase" class="external-link">phylobase</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'phylobase'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:ape':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     edges</span></span></code></pre></div>
<p>Phylogenetic trees are sampled to various completeness. In some cases
the phylogeny includes all species of a given taxonomic group, in other
words it has 100% species sampling. For other taxonomic groups the
percentage sampling coverage is often lower. This is at the level of the
taxonomic group, e.g. all Vipers (family <em>Viperidae</em>) assuming
that all species have a single tip in the phylogeny. However, at the
level of the species it is possible to have more than one sample per
species and these can be used in phylogenetic inference to produce a
phylogeny with multiple phylogenetic tips per species. These can
optionally be collapsed into a single tip for each species, but for
extracting phylogenetic island community data, e.g. using DAISIEprep, it
can be beneficial to make use of the extra information of multiple tips
per species, for example to infer a maxmimum and minimum colonisation
time.</p>
<p>This vignette outlines at a high-level the different types of
phylogenetic information empiricists might possess and the different
endemicity status encodings used, and how extracting island community
data using <code><a href="../reference/extract_island_species.html">extract_island_species()</a></code> works in each.</p>
<div class="section level2">
<h2 id="scenario-species-dependent-endemicity-encoding">Scenario: species-dependent endemicity encoding<a class="anchor" aria-label="anchor" href="#scenario-species-dependent-endemicity-encoding"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rcoal</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Plant"</span>, <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Plant_d_a"</span></span>
<span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Plant_d_b"</span></span>
<span><span class="va">phylo</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4-methods.html" class="external-link">phylo4</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span><span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"nonendemic"</span>, </span>
<span>                       <span class="st">"nonendemic"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, </span>
<span>                       <span class="st">"not_present"</span>, <span class="st">"endemic"</span>, <span class="st">"not_present"</span><span class="op">)</span></span>
<span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">phylo</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">endemicity_status</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_phylod.html">plot_phylod</a></span><span class="op">(</span><span class="va">phylod</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multi_tip_extraction_files/figure-html/sim-data-1.png" width="768"></p>
<p>In this scenario we have a plant phylogeny with 9 species, and
species “Plant_d” has two samples/tips in the tree. The samples are
differentiated by the suffix labels: “_a” and “_b”.</p>
<p>Both “Plant_d” tips are labelled “nonendemic”, and this encoding is
independent of where the samples for each tip were collected
(<em>species-dependent labelling</em>), i.e. it is unknown if the
non-endemic species have been sampled once on the island and once on the
mainland, or twice on the island, or twice on the mainland. For the
species-dependent encoding we assume that all tips are on the island and
use the stem age of the species as the island colonisation time and the
within species divergence as the minimum colonisation time when using
the <code>"min"</code> extraction method.</p>
<p>There is one more island species in the phylogeny, “Plant_i”, which
is endemic.</p>
<p>We can now extract the island community data using the
<code>"min"</code> algorithm:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span>phylod <span class="op">=</span> <span class="va">phylod</span>, extraction_method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span>
<span><span class="va">island_tbl</span></span>
<span><span class="co">#&gt; Class:  Island_tbl </span></span>
<span><span class="co">#&gt;   clade_name     status missing_species   col_time col_max_age branching_times</span></span>
<span><span class="co">#&gt; 1    Plant_d nonendemic               0 0.06146596        TRUE              NA</span></span>
<span><span class="co">#&gt; 2    Plant_i    endemic               0 0.04960523       FALSE              NA</span></span>
<span><span class="co">#&gt;      min_age      species clade_type</span></span>
<span><span class="co">#&gt; 1 0.05480904 Plant_d_....          1</span></span>
<span><span class="co">#&gt; 2         NA      Plant_i          1</span></span></code></pre></div>
<p>You can see that the extraction has successful extracted 2 island
colonisations. The endemic “Plant_i” is extracted as per usual so we
will not focus on that.</p>
<p>The “Plant_d” species has been correctly extracted as a single
non-endemic species with a colonisation time (<code>col_time</code>), a
minimum age of colonisation (<code>min_age</code>) which is taken from
the branching time between the two non-endemic tips on the island. The
logic here being that it is parsimonious to assume that the species
colonised the island once and diverged on the island, and therefore the
divergence would have been after the colonisation, providing a minimum
bound to the colonisation time. There are no branching times
(<code>branching_times</code> is <code>NA</code>) because there are no
species-level speciation events on the island, only divergence below the
level of the species.</p>
</div>
<div class="section level2">
<h2 id="scenario-geography-dependent-endemicity-encoding">Scenario: geography-dependent endemicity encoding<a class="anchor" aria-label="anchor" href="#scenario-geography-dependent-endemicity-encoding"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, </span>
<span>                       <span class="st">"nonendemic"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>,</span>
<span>                       <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"endemic"</span>, <span class="st">"not_present"</span><span class="op">)</span></span>
<span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">phylo</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">endemicity_status</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_phylod.html">plot_phylod</a></span><span class="op">(</span><span class="va">phylod</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multi_tip_extraction_files/figure-html/sample-label-1.png" width="768"></p>
<p>In this scenario we use the same phylogenetic data, but use a
different labelling scheme. This time we use what we term
<em>geography-dependent labelling</em>. This is where the tips in the
phylogeny for multi-tip species are labelled according to where the
sample was collected. So a sample from a non-endemic species sampled on
the island would be labelled <code>"nonendemic"</code>, but another
sample from the same species from the mainland will be labelled
<code>"not_present"</code>.</p>
<p>The difference in the data with the first scenario is “Plant_d_b” is
sampled from the mainland so it is now encoded as not being present on
the island (<code>"not_present"</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span>phylod <span class="op">=</span> <span class="va">phylod</span>, extraction_method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span>
<span><span class="va">island_tbl</span></span>
<span><span class="co">#&gt; Class:  Island_tbl </span></span>
<span><span class="co">#&gt;   clade_name     status missing_species   col_time col_max_age branching_times</span></span>
<span><span class="co">#&gt; 1  Plant_d_a nonendemic               0 0.05480904       FALSE              NA</span></span>
<span><span class="co">#&gt; 2    Plant_i    endemic               0 0.04960523       FALSE              NA</span></span>
<span><span class="co">#&gt;   min_age   species clade_type</span></span>
<span><span class="co">#&gt; 1      NA Plant_d_a          1</span></span>
<span><span class="co">#&gt; 2      NA   Plant_i          1</span></span></code></pre></div>
<p>We extract the island community data and see that again 2
colonisations are inferred, but this time there is not a
<code>min_age</code> extracted as there are no subspecies divergences on
the island.</p>
</div>
<div class="section level2">
<h2 id="scenario-species-dependent-endemicity-encoding-endemics">Scenario: species-dependent endemicity encoding (endemics)<a class="anchor" aria-label="anchor" href="#scenario-species-dependent-endemicity-encoding-endemics"></a>
</h2>
<p>Revisiting the first scenario where we had multiple tips in the
phylogeny from the same species, all labelled as non-endemic,
independent of where the species sample came from, but this time the
species is endemic to the island rather than non-endemic.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"endemic"</span>, </span>
<span>                       <span class="st">"endemic"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, </span>
<span>                       <span class="st">"not_present"</span>, <span class="st">"endemic"</span>, <span class="st">"not_present"</span><span class="op">)</span></span>
<span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">phylo</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">endemicity_status</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_phylod.html">plot_phylod</a></span><span class="op">(</span><span class="va">phylod</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multi_tip_extraction_files/figure-html/species-encode-endemic-1.png" width="768"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span>phylod <span class="op">=</span> <span class="va">phylod</span>, extraction_method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span>
<span><span class="va">island_tbl</span></span>
<span><span class="co">#&gt; Class:  Island_tbl </span></span>
<span><span class="co">#&gt;   clade_name  status missing_species   col_time col_max_age branching_times</span></span>
<span><span class="co">#&gt; 1    Plant_d endemic               0 0.06146596        TRUE              NA</span></span>
<span><span class="co">#&gt; 2    Plant_i endemic               0 0.04960523       FALSE              NA</span></span>
<span><span class="co">#&gt;      min_age      species clade_type</span></span>
<span><span class="co">#&gt; 1 0.05480904 Plant_d_....          1</span></span>
<span><span class="co">#&gt; 2         NA      Plant_i          1</span></span></code></pre></div>
<p>The same extraction procedure, using the <code>"min"</code>
algorithm, produces two endemic colonists. The multi-tip species is
extracted with a colonisation time taken as the stem age of the species
and minimum time of colonisation is taken from the within-species
divergence (branching) time.</p>
<p>The extraction also works if you have more samples/tips per species.
Here we increase the number of tips in the “Plant_d” species to 4.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/labels-methods.html" class="external-link">tipLabels</a></span><span class="op">(</span><span class="va">phylo</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Plant_a"</span>, <span class="st">"Plant_d_a"</span>, <span class="st">"Plant_d_b"</span>,</span>
<span>                                 <span class="st">"Plant_d_c"</span>, <span class="st">"Plant_d_d"</span>, <span class="st">"Plant_b"</span>, <span class="st">"Plant_c"</span>,</span>
<span>                                 <span class="st">"Plant_e"</span>, <span class="st">"Plant_f"</span>, <span class="st">"Plant_g"</span><span class="op">)</span></span>
<span><span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not_present"</span>, <span class="st">"endemic"</span>, <span class="st">"endemic"</span>, <span class="st">"endemic"</span>, </span>
<span>                       <span class="st">"endemic"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, </span>
<span>                       <span class="st">"not_present"</span>, <span class="st">"endemic"</span>, <span class="st">"not_present"</span><span class="op">)</span></span>
<span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">phylo</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">endemicity_status</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_phylod.html">plot_phylod</a></span><span class="op">(</span><span class="va">phylod</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multi_tip_extraction_files/figure-html/species-encode-endemic-3-1.png" width="768"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span>phylod <span class="op">=</span> <span class="va">phylod</span>, extraction_method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span>
<span><span class="va">island_tbl</span></span>
<span><span class="co">#&gt; Class:  Island_tbl </span></span>
<span><span class="co">#&gt;   clade_name  status missing_species   col_time col_max_age branching_times</span></span>
<span><span class="co">#&gt; 1    Plant_d endemic               0 0.09053720        TRUE              NA</span></span>
<span><span class="co">#&gt; 2    Plant_f endemic               0 0.04960523       FALSE              NA</span></span>
<span><span class="co">#&gt;      min_age      species clade_type</span></span>
<span><span class="co">#&gt; 1 0.06146596 Plant_d_....          1</span></span>
<span><span class="co">#&gt; 2         NA      Plant_f          1</span></span></code></pre></div>
<p>The minimum age of colonisation in this case is the crown age of the
4 samples of the same species, with all species samples stored in the
<code>$species</code> column.</p>
</div>
<div class="section level2">
<h2 id="scenario-geography-dependent-endemicity-encoding-multiple-island-samples">Scenario: geography-dependent endemicity encoding (multiple island
samples)<a class="anchor" aria-label="anchor" href="#scenario-geography-dependent-endemicity-encoding-multiple-island-samples"></a>
</h2>
<p>Lastly, we look once again at the endemicity encoding where island
samples are labelled as endemic or non-endemic, and mainland samples are
labelled not on the island (even if a non-endemic island species,
<em>geography-dependent labelling</em>). This time with multiple samples
from the island that are monophyletic.</p>
<p>In this scenario we look at a simple case of a single island species
(“Plant_g”) in the tree, with 3 samples, 2 on the island
(“Plant_g_island_a” and “Plant_g_island_b”) and 1 on the mainland
(“Plant_g_mainland”).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/labels-methods.html" class="external-link">tipLabels</a></span><span class="op">(</span><span class="va">phylo</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Plant_a"</span>, <span class="st">"Plant_b"</span>, <span class="st">"Plant_c"</span>, <span class="st">"Plant_d"</span>,</span>
<span>                                 <span class="st">"Plant_e"</span>, <span class="st">"Plant_f"</span>, <span class="st">"Plant_g_mainland"</span>,</span>
<span>                                 <span class="st">"Plant_g_island_b"</span>, <span class="st">"Plant_g_island_a"</span>, </span>
<span>                                 <span class="st">"Plant_h"</span><span class="op">)</span></span>
<span><span class="va">endemicity_status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, </span>
<span>                       <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, <span class="st">"not_present"</span>, </span>
<span>                       <span class="st">"not_present"</span>, <span class="st">"nonendemic"</span>, <span class="st">"nonendemic"</span>, </span>
<span>                       <span class="st">"not_present"</span><span class="op">)</span></span>
<span><span class="va">phylod</span> <span class="op">&lt;-</span> <span class="fu">phylobase</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phylobase/man/phylo4d-methods.html" class="external-link">phylo4d</a></span><span class="op">(</span><span class="va">phylo</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">endemicity_status</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_phylod.html">plot_phylod</a></span><span class="op">(</span><span class="va">phylod</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multi_tip_extraction_files/figure-html/geo-encode-2-island-1.png" width="768"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">island_tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_island_species.html">extract_island_species</a></span><span class="op">(</span>phylod <span class="op">=</span> <span class="va">phylod</span>, extraction_method <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span></span>
<span><span class="va">island_tbl</span></span>
<span><span class="co">#&gt; Class:  Island_tbl </span></span>
<span><span class="co">#&gt;   clade_name     status missing_species  col_time col_max_age branching_times</span></span>
<span><span class="co">#&gt; 1    Plant_g nonendemic               0 0.3800341        TRUE              NA</span></span>
<span><span class="co">#&gt;      min_age      species clade_type</span></span>
<span><span class="co">#&gt; 1 0.04960523 Plant_g_....          1</span></span></code></pre></div>
<p>The extracted island colonist has a colonisation time as the stem age
of the island samples and the minimum colonisation time as the
divergence of the island samples.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua W. Lambert, Luis Valente, Pedro Santos Neves, Lizzie Roeble, Theo Pannetier.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>

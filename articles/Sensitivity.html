<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="DAISIEprep">
<title>Sensitivity • DAISIEprep</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sensitivity">
<meta property="og:description" content="DAISIEprep">
<meta property="og:image" content="https://joshwlambert.github.io/DAISIEprep/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">DAISIEprep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Performance.html">Performance</a>
    <a class="dropdown-item" href="../articles/Sensitivity.html">Sensitivity</a>
    <a class="dropdown-item" href="../articles/Tutorial.html">DAISIEprep Tutorial</a>
    <a class="dropdown-item" href="../articles/Extending_asr.html">Extending DAISIEprep ASR models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/joshwlambert/DAISIEprep/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sensitivity</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/joshwlambert/DAISIEprep/blob/HEAD/vignettes/Sensitivity.Rmd" class="external-link"><code>vignettes/Sensitivity.Rmd</code></a></small>
      <div class="d-none name"><code>Sensitivity.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we provide a set of best practices for sensitivity
analyses that should be taken into consideration when conducting data
formatting and model fitting in the DAISIE and DAISIEprep framework.
Sensitivty analyses is the testing of a model output to variations in
the model input. A model is considered sensitive if the model output
vastly changes due to relatively small perturbations in the data input
into the model. These small perturbations may be due to uncertainty in
the data (i.e. a posterior distribution of possible branching times in a
phylogeny), measurement error, or other factors. In the case we are
interested in, these perturbations are variation in island colonisation
and branching times, endemicity status on the island and number of
colonisations events. Each of these can change if using multiple
phylogenies from the posterior distribution of inferred phylogenies, or
using different extraction algorithms in DAISIEprep.</p>
<p>Firstly we discuss thetype of variations in the data and how each of
these can impact parameter estimation. Another aspect of sensitivity
analysis, which we will not explore in this vignette, is the sensitivity
of model selection to input data variation. By this we mean the best-fit
model and the ranking of the model (by likelihood, AIC, BIC, or other
metric) may change given differences in the data. This can be equally as
important as sensitivity of parameter estimates and we recommend users
check model selection as well as parameter estimates in their work.</p>
</div>
<div class="section level2">
<h2 id="sensitivity-to-extraction-method">Sensitivity to extraction method<a class="anchor" aria-label="anchor" href="#sensitivity-to-extraction-method"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshwlambert/DAISIEprep" class="external-link">DAISIEprep</a></span><span class="op">)</span></span></code></pre></div>
<p>The <code>DAISIEprep</code> R package provides the tools to extract
phylogenetic community data from phylogenetic trees with the endemicity
status of the species assigned to each tip in the phylogeny. However,
there is not a single correct method for extracting the data and thus
<code>DAISIEprep</code> implements several algorithms to account for
variations in what would be considered an appropriate assumptions for
the island system of interest. The two major divisions for extracting
data are in the <code>extraction_method</code> argument in
<code><a href="../reference/extract_island_species.html">extract_island_species()</a></code> (and by extension
<code>extract_multi_island_species()</code>), which can be either
<code>"min"</code> for the minimum time of colonisation algorithm, or
<code>"asr"</code> for the geographical ancestral state reconstruction
algorithm. The <code>"min"</code> algorithm conforms to the assumptions
of the DAISIE inference model (implemented in the <a href="https://cran.r-project.org/package=DAISIE/index.html" class="external-link"><code>DAISIE</code>
R package</a>). These assumptions are:</p>
<ul>
<li>Non-endemic species cannot be part of an island clade</li>
<li>There is no back-colonisation from the island away to the mainland
or other island</li>
<li>There cannot be a species not present on the island nested in an
endemic island clade</li>
</ul>
<p>The all points are linked, by not allowing back-colonisation, a
species on the islands cannot be endemic to the island (i.e. part of an
endemic island radiation) and then migrate or expand its range away from
the island. These three points mean that if the island system of
interest has experienced back-colonisation or a species in an endemic
island radiation has expanded its range off the island and its island
population has gone extinct (making it not present on the island but
extant) the <code>"min"</code> algorithm will split clades into multiple
colonisations. In the case that the island of interest is very remote
and species colonisation and diversify and do not disperse off the
island, this algorithm provides a simple model to extract the data.</p>
<p>However, it is clear that this common assumptions of the DAISIE model
and thus the <code>"min"</code> algorithm are violated in empirical
data. Therefore the second algorithm, <code>"asr"</code>, is implemented
to remedy this. The <code>"asr"</code> algorithm uses the reconstructed
states at each node in the phylogeny inferring whether a species is not
present on the island, non-endemic to the island, or endemic to the
island. Using this information the algorithm can traverse the phylogeny
back to the node where the island clade colonised the island. This
algorithm overcomes the limitations of the <code>"min"</code> algorithm
by allowing non-endemic species to be part of island clades (extracting
them as endemic clades for the purposes of applying the DAISIE inference
model), and additionally allowing species that are not present on the
island to be included in data when embedded within an endemic island
clade (this feature is turned on/off with the
<code>include_not_present</code> argument in
<code><a href="../reference/extract_island_species.html">extract_island_species()</a></code>). Therefore, the
<code>"asr"</code> algorithm has benefits when the focal island system
has experienced some species movement from the island to other regions.
However, it is not without limitations, ancestral state reconstruction
models should be interpreted with caution and uncertainty of a species
geographic range deep in the past, near the root of the tree is often
high leading to variability in interpretation of whether a species was
present on the island at the time. The formulation of the ancestral
state reconstruction model is also important, with the transition matrix
between states crucial to plausible results. By default we use a
symmetrical transition structure where species go from not present on
the island, to non-endemic and then to endemic. Without jumps from not
present to endemic and vice versa. This is in line with the reasoning in
the DAISIE model that species that colonise the island do not migrate
their entire mainland population, instead going through a widespread
range, before becoming endemic via cladogenesis or anagenesis on the
island, or extinction of the mainland population.</p>
<p>In this vignette we demonstrate the sensitivity of the parameters
estimated from the DAISIE maximum likelihood inference model to changes
in the algorithm used to extract the data. We apply the
<code>"min"</code> and <code>"asr"</code> algorithms, and within
<code>"asr"</code> we apply two different models of ancestral state
reconstruction: parsimony and continuous-time Markov model (Mk model).
Traditionally, these have been two of the most common methods for
reconstructing ancestral states, for other methods to reconstruct
ancestral ranges see Extending_asr vignette in the
<code>DAISIEprep</code> package.</p>
<p>The data we use for this example is the macro-phylogeny of
mammals<span class="citation">(Upham et al. 2019)</span> and the island
endemicity data of Madagascar <span class="citation">(Michielsen et al.
2023)</span>. The mammal phylogeny is a global phylogeny containing most
mammal species and the Madagascar checklist is the most up-to-date
catelog of Madagascars mammal fauna. The phylogeny is constructed from
genetic sequences to create the DNA-only phylogeny. Species that are
known but for which genetic data is unavailable are inserted into the
tree using a polytomy resolving technique which produces the complete
phylogeny. We test the sensitivity of estimates for both the DNA-only
and complete phylogenies.</p>
<p>The results presented in this vignette are not computing each time
the vignette is rendered due to the large computation time required.
Instead, the analyses are run on a cluster computer and saved in the
package. The analysis script run to produce the results can be found in
the <a href="https://github.com/joshwlambert/DAISIEprepExtra" class="external-link">DAISIEprepExtra</a>
package <a href="https://github.com/joshwlambert/DAISIEprepExtra/tree/main/inst/scripts" class="external-link">here</a>.
The sensitivity analysis uses the <code><a href="../reference/sensitivity.html">sensitivity()</a></code> function in
the <code>DAISIEprep</code> package.</p>
<p>The <code><a href="../reference/sensitivity.html">sensitivity()</a></code> function creates a table of all
possible combination of data extraction settings, given the input
arguments, and this forms our parameter space for the sensitivity
analysis. The phylogenetic trees and island endemicity data is provided
to carry out the extraction and formatting. <code>DAISIEprep</code> uses
the <code>phylo4d</code> class from the <code>phylobase</code> R
package. However, for the <code><a href="../reference/sensitivity.html">sensitivity()</a></code> function a
<code>phylo</code> object can be provided and all the house-keeping is
taken care of inside the function. The <code><a href="../reference/sensitivity.html">sensitivity()</a></code>
function loops through each parameter setting and extracts and formats
the data and fit the DAISIE maximum likelihood inference model
(<code><a href="https://rsetienne.github.io/DAISIE/reference/DAISIE_ML.html" class="external-link">DAISIE::DAISIE_ML_CS()</a></code>) to the data.</p>
<p>The output produces results for the DNA-only phylogeny and the
complete phylogeny. The raw data of parameter estimates for the
different parameter settings is tidied into a tibble containing the data
we need for both the DNA and complete phylogeny.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sensitivity_data</span> <span class="op">&lt;-</span> <span class="fu">DAISIEprep</span><span class="fu">:::</span><span class="fu"><a href="../reference/read_sensitivity.html">read_sensitivity</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>We can plot the distribution of parameter estimates for the DNA and
complete data sets.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DAISIEprep</span><span class="fu">:::</span><span class="fu"><a href="../reference/plot_sensitivity.html">plot_sensitivity</a></span><span class="op">(</span></span>
<span>  sensitivity_data <span class="op">=</span> <span class="va">sensitivity_data</span><span class="op">$</span><span class="va">sensitivity_dna</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Sensitivity_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DAISIEprep</span><span class="fu">:::</span><span class="fu"><a href="../reference/plot_sensitivity.html">plot_sensitivity</a></span><span class="op">(</span></span>
<span>  sensitivity_data <span class="op">=</span> <span class="va">sensitivity_data</span><span class="op">$</span><span class="va">sensitivity_complete</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Sensitivity_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Most parameters are relatively unsensitivite to the different
phylogenies across the posterior distribution of possible trees. The
noticable outlier is colonisation rate, where the choice of extraction
algorithm heavily influences the inferred rate of island colonisation.
The <code>"min"</code> algorithm shows the highest rate of colonisation,
likely due to breaking up island clades that may have undergone some
back-colonisation. The smallest estimated colonisation rate comes from
the <code>"asr"</code> algorithm using parsimony to reconstruct the
geographical states in the phylogeny. This can be explained by parsimony
favouring the fewest number of state changes (i.e. range shifts from
mainland to island), which translates into fewer colonisation events and
likely lumping clades together which may have independently colonised
the island.</p>
<p>An alternative plot is to look at the pairwise comparisons of each
estimated rate from the DAISIE inference model across each posterior
phylogeny.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DAISIEprep</span><span class="fu">:::</span><span class="fu"><a href="../reference/plot_sensitivity.html">plot_sensitivity</a></span><span class="op">(</span></span>
<span>  sensitivity_data <span class="op">=</span> <span class="va">sensitivity_data</span><span class="op">$</span><span class="va">sensitivity_dna</span>,</span>
<span>  pairwise_diffs <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Sensitivity_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DAISIEprep</span><span class="fu">:::</span><span class="fu"><a href="../reference/plot_sensitivity.html">plot_sensitivity</a></span><span class="op">(</span></span>
<span>  sensitivity_data <span class="op">=</span> <span class="va">sensitivity_data</span><span class="op">$</span><span class="va">sensitivity_complete</span>,</span>
<span>  pairwise_diffs <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Sensitivity_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The general pattern is the same as the density plots shown above. The
rates of cladogenesis, anagenesis and extinction are largely clusters
with little clear separation of estimates by extraction method. The
exception is again colonisation rate which shows visible clustering of
rate estimates based on which extraction method is chosen.</p>
<p>Here we have demonstrated the variability, or lack of, in parameter
estimates from phylogenetic data on an island community when changing
the data as well as the choice of extraction algorithm.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-michielsen_macroevolutionary_2023" class="csl-entry">
Michielsen, N. M., S. M. Goodman, V. Soarimalala, A. A. E. van der Geer,
L. M. Dávalos, G. I. Saville, N. Upham, and L. Valente. 2023. <a href="https://doi.org/10.1038/s41467-022-35215-3" class="external-link">The macroevolutionary
impact of recent and imminent mammal extinctions on madagascar</a>.
Nature Communications 14. Springer Science; Business Media
<span>LLC</span>.
</div>
<div id="ref-upham_inferring_2019" class="csl-entry">
Upham, N. S., J. A. Esselstyn, and W. Jetz. 2019. <a href="https://doi.org/10.1371/journal.pbio.3000494" class="external-link">Inferring the mammal
tree: Species-level sets of phylogenies for questions in ecology,
evolution, and conservation</a>. <span>PLOS</span> Biology 17:e3000494.
Public Library of Science (<span>PLoS</span>).
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Joshua W. Lambert, Luis Valente, Pedro Santos Neves, Lizzie Roeble, Theo Pannetier.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
